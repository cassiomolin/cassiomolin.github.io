<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Using HTTP PATCH in Spring | cassiomolin</title>
  <meta name='description' content='I am a software engineer living and working in Ireland. And this is my not-so-frequently-updated coding blog.'>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Using HTTP PATCH in Spring | cassiomolin</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Using HTTP PATCH in Spring" />
<meta name="author" content="Cassio Mazzochi Molin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post demonstrates an approach to support HTTP PATCH in Spring." />
<meta property="og:description" content="This post demonstrates an approach to support HTTP PATCH in Spring." />
<link rel="canonical" href="https://cassiomolin.com/2019/06/10/using-http-patch-in-spring/" />
<meta property="og:url" content="https://cassiomolin.com/2019/06/10/using-http-patch-in-spring/" />
<meta property="og:site_name" content="cassiomolin" />
<meta property="og:image" content="https://cassiomolin.com/assets/images/posts/2019-06-10-using-http-patch-in-spring/cover.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-06-10T23:35:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://cassiomolin.com/assets/images/posts/2019-06-10-using-http-patch-in-spring/cover.jpg" />
<meta property="twitter:title" content="Using HTTP PATCH in Spring" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Cassio Mazzochi Molin"},"dateModified":"2019-06-10T23:35:00+00:00","datePublished":"2019-06-10T23:35:00+00:00","description":"This post demonstrates an approach to support HTTP PATCH in Spring.","headline":"Using HTTP PATCH in Spring","image":"https://cassiomolin.com/assets/images/posts/2019-06-10-using-http-patch-in-spring/cover.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://cassiomolin.com/2019/06/10/using-http-patch-in-spring/"},"url":"https://cassiomolin.com/2019/06/10/using-http-patch-in-spring/"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="canonical" href="https://cassiomolin.com/2019/06/10/using-http-patch-in-spring/">
  <link rel="alternate" type="application/rss+xml" title="cassiomolin" href="/feed.xml">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com"> 
  <link href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i&display=swap" rel="stylesheet">

  <!-- LineIcons -->
  <link href="https://cdn.lineicons.com/2.0/LineIcons.css" rel="stylesheet">

  <!-- Favicon and other icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icon//favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icon//favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69796629-3', 'auto');
  ga('send', 'pageview');
</script>
  

  <style>
  
  /*!------------------------------------------------------------------
[MAIN STYLESHEET]
-------------------------------------------------------------------*/.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.show{display:block}.hide{display:none}.invisible{visibility:hidden}.list-reset{list-style-type:none;margin:0;padding:0}.clearfix::after,.clearfix ::before{content:"";display:table;clear:both}.screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:30px}ul,ol,dd{margin-left:20px}.highlight{border-radius:4px;color:#fff;background:#17151E;font-size:14px;border-radius:16px}.highlight code[class*="language-"],.highlight pre[class*="language-"]{color:#ccc;background:none;font-family:Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}.highlight pre[class*="language-"]{padding:1em;overflow:auto}.highlight :not(pre)>code[class*="language-"],.highlight pre[class*="language-"]{background:#17151E}.highlight :not(pre)>code[class*="language-"]{padding:.1em;border-radius:.3em;white-space:normal}.highlight .token.comment,.highlight .token.block-comment,.highlight .token.prolog,.highlight .token.doctype,.highlight .token.cdata{color:#999}.highlight .token.punctuation{color:#ccc}.highlight .token.tag,.highlight .token.attr-name,.highlight .token.namespace,.highlight .token.deleted{color:#e2777a}.highlight .token.function-name{color:#6196cc}.highlight .token.boolean,.highlight .token.number,.highlight .token.function{color:#f08d49}.highlight .token.property,.highlight .token.class-name,.highlight .token.constant,.highlight .token.symbol{color:#f8c555}.highlight .token.selector,.highlight .token.important,.highlight .token.atrule,.highlight .token.keyword,.highlight .token.builtin{color:#cc99cd}.highlight .token.string,.highlight .token.char,.highlight .token.attr-value,.highlight .token.regex,.highlight .token.variable{color:#7ec699}.highlight .token.operator,.highlight .token.entity,.highlight .token.url{color:#67cdcc}.highlight .token.important,.highlight .token.bold{font-weight:bold}.highlight .token.italic{font-style:italic}.highlight .token.entity{cursor:help}.highlight .token.inserted{color:green}.container{max-width:1340px;padding-left:20px;padding-right:20px;margin:0 auto}.container-big{max-width:1600px;padding-left:20px;padding-right:20px;margin:0 auto}.row{display:flex;flex-wrap:wrap;flex:0 1 auto;flex-direction:row;box-sizing:border-box;margin-left:-16px;margin-right:-16px}.col{padding-left:16px;padding-right:16px}[class^="col-"]{flex:auto}.col-0{width:0%}.col-1{width:8.3333333333%}.col-2{width:16.6666666667%}.col-3{width:25%}.col-4{width:33.3333333333%}.col-5{width:41.6666666667%}.col-6{width:50%}.col-7{width:58.3333333333%}.col-8{width:66.6666666667%}.col-9{width:75%}.col-10{width:83.3333333333%}.col-11{width:91.6666666667%}.col-12{width:100%}.push-0{margin-left:0%}.push-1{margin-left:8.3333333333%}.push-2{margin-left:16.6666666667%}.push-3{margin-left:25%}.push-4{margin-left:33.3333333333%}.push-5{margin-left:41.6666666667%}.push-6{margin-left:50%}.push-7{margin-left:58.3333333333%}.push-8{margin-left:66.6666666667%}.push-9{margin-left:75%}.push-10{margin-left:83.3333333333%}.push-11{margin-left:91.6666666667%}.push-12{margin-left:100%}.pull-0{margin-right:0%}.pull-1{margin-right:8.3333333333%}.pull-2{margin-right:16.6666666667%}.pull-3{margin-right:25%}.pull-4{margin-right:33.3333333333%}.pull-5{margin-right:41.6666666667%}.pull-6{margin-right:50%}.pull-7{margin-right:58.3333333333%}.pull-8{margin-right:66.6666666667%}.pull-9{margin-right:75%}.pull-10{margin-right:83.3333333333%}.pull-11{margin-right:91.6666666667%}.pull-12{margin-right:100%}@media (max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media (max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media (max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}img[data-action="zoom"]{cursor:pointer;cursor:-webkit-zoom-in;cursor:-moz-zoom-in}.zoom-img,.zoom-img-wrap{position:relative;z-index:999;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}img.zoom-img{cursor:pointer;cursor:-webkit-zoom-out;cursor:-moz-zoom-out}.zoom-overlay{z-index:420;background:#0f0e15;position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;opacity:0;-webkit-transition:opacity 300ms;-o-transition:opacity 300ms;transition:opacity 300ms}@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none){.zoom-overlay{-webkit-backdrop-filter:saturate(180%) blur(24px);backdrop-filter:saturate(180%) blur(24px);background:rgba(15,14,21,0.8)}}.zoom-overlay-open .zoom-overlay{opacity:1}.zoom-overlay-open,.zoom-overlay-transitioning{cursor:default}.animate{animation:animateElement cubic-bezier(0.3, 0.45, 0.45, 0.95) 0.75s;animation-duration:0.75s;animation-iteration-count:1}@keyframes animateElement{0%{opacity:0}100%{opacity:1}}*,*::after,*::before{box-sizing:border-box}@media only print{*,*::after,*::before{color:#000 !important}}body{font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:18px;line-height:1.7;color:#eee;background-color:#0f0e15;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-x:hidden}body.is-in::after{visibility:hidden;opacity:0;pointer-events:none}body::after{content:"";position:fixed;left:0;top:0;width:100%;height:100%;background-color:#09080f;z-index:999;transition:1s}body input,body textarea{border:1px solid #eee;outline:none}body.overlay-active{overflow:hidden}@media only screen and (max-width: 576px){body{font-size:16px;line-height:29px}}::placeholder{color:#aaa}*::selection{color:#fff;background-color:rgba(255,123,123,0.7)}h1,h2,h3,h4,h5,h6{font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-weight:700;line-height:1.4em;letter-spacing:-1px;color:#eee}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}blockquote{position:relative;padding:50px 0px 30px 70px;margin-bottom:0;color:#fff}blockquote:before{content:'\201C';position:absolute;left:0;font-size:8em;line-height:0;color:#ff7b7b}blockquote p{margin-bottom:20px}blockquote cite{font-size:16px;font-style:normal;font-weight:700;color:#eee}blockquote cite:before{content:'\2014' '\00a0'}@media only screen and (max-width: 576px){blockquote{padding:50px 0px 30px 60px}}pre{overflow:auto;padding:20px;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}img,.zoom-img-wrap{max-width:100%;height:auto;vertical-align:middle}img+em,.zoom-img-wrap+em{display:inline-block;width:100%;padding:20px 0 0;font-size:12px;font-style:normal;line-height:1;text-align:center;color:#eee}a{text-decoration:none;color:#eee;transition:all 0.2s}a:hover{color:#ff7b7b}hr{display:block;width:100%;margin:40px 0 80px 0;border:0;text-align:center}hr:after{content:"* * *";font-size:2em}.table-container{display:block;max-width:100%;overflow-x:auto}table{font-size:12px;color:rgba(238,238,238,0.7);width:100%;border-width:1px;border-color:#09080f;border-collapse:collapse}table th{padding:12px;font-size:16px;text-align:left;border:1px solid #09080f;color:#fff;background-color:#17151E}table tr{background-color:#09080f;transition:all .3s ease}table tr:nth-child(even){background-color:transparent}table tr:hover{color:#fff}table td{padding:12px;font-size:14px;border:1px solid #09080f}.gallery-box{margin-bottom:30px}.gallery-box em{display:inline-block;width:100%;padding:20px 0 0;font-size:12px;font-style:normal;line-height:1;text-align:center;color:#eee}.gallery-box em a{border-bottom:2px solid rgba(238,238,238,0.1)}.gallery-box em a:hover{border-color:#ff7b7b;color:#eee;text-decoration:none}.gallery{display:grid;grid-template-columns:repeat(3, auto);justify-content:center;align-content:center;grid-gap:10px}.gallery img{width:100%;height:auto}.lazy{opacity:0;transition:0.4s ease}.lazy.loaded{opacity:1}.hero{position:relative;margin-bottom:32px;overflow:hidden;background-color:#09080f}@media only screen and (max-width: 576px){.hero{box-shadow:none}}.hero__inner::before{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;background:linear-gradient(180deg, rgba(15,14,21,0.6) 0%, #0f0e15 100%)}.hero__image{min-height:664px;user-select:none;background-color:#09080f}.hero__image img{position:absolute;top:0px;width:100%;height:100%;object-fit:cover}@media only screen and (max-width: 992px){.hero__image{min-height:620px}}@media only screen and (max-width: 768px){.hero__image{min-height:500px}}@media only screen and (max-width: 576px){.hero__image{min-height:400px}}.hero__content{position:absolute;top:55%;left:50%;transform:translate(-50%, -50%);z-index:1;width:100%;max-width:650px;padding:0 20px;text-align:center}.hero__content .social{margin-top:30px}.home .hero__content{top:calc(55% + 30px)}.hero__title{font-size:58px;margin:0 0 10px;line-height:1;color:#fff}@media only screen and (max-width: 576px){.hero__title{font-size:32px;margin:0 0 10px}}.hero__desc{font-size:20px;color:#aaa;margin:0}@media only screen and (max-width: 576px){.hero__desc{font-size:16px;line-height:21px}}.hero-without-image{margin:192px 0 96px}.hero-without-image .hero-inner{display:flex;align-items:center;justify-content:center}.hero-without-image .hero-content{width:100%;max-width:650px;padding:0 20px;text-align:center}@media only screen and (max-width: 576px){.hero-without-image{margin:144px 0 48px}}.top{position:fixed;bottom:25px;right:-100px;z-index:5;width:40px;height:40px;line-height:40px;text-align:center;border-radius:8px;background-color:#09080f;color:#fff;cursor:pointer;transition:all .25s ease}.top:hover{color:#09080f;background:#ff7b7b}.top.is-active{right:30px}@media only screen and (max-width: 768px){.top{bottom:15px}.top.is-active{right:25px}}.header{width:100%;margin:60px 0 120px;transition:all 0.2s;color:#fff}.header.header--top{position:absolute;top:0;z-index:100}@media only screen and (max-width: 992px){.header{margin:30px 0 60px}}.header__inner{position:relative;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}.logo__link{font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:28px;line-height:1;font-weight:900;vertical-align:middle;color:#eee;text-decoration:none;letter-spacing:-1px}.logo__link:hover{color:#ff7b7b}.logo__image{max-height:40px}.main-nav{width:100%;max-width:1300px;margin:0 auto}.main-nav__box{display:flex;align-items:center;width:80%;padding-top:200px;margin:0 auto}.main-nav__box .nav__icon-close{position:absolute;top:32px;right:20px;z-index:5;display:flex;align-items:center;justify-content:center;font-size:30px;text-align:center;line-height:40px;color:rgba(255,255,255,0.5);transition:all .25s ease;cursor:pointer}.main-nav__box .nav__icon-close:hover{color:#fff}@media only screen and (max-width: 768px){.main-nav__box{padding-top:100px}.main-nav__box .nav__icon-close{top:32px;right:20px}}@media only screen and (max-width: 576px){.main-nav__box{width:90%}}.navigation{display:flex;align-items:center}.top-nav .nav__list .nav__item{display:inline-block;margin-right:40px}.top-nav .nav__list .nav__item:last-child{margin-right:0}.top-nav .nav__list .nav__item .nav__link{position:relative;font-size:14px;font-weight:700;letter-spacing:1px;text-transform:uppercase;text-decoration:none;color:#eee}.top-nav .nav__list .nav__item .nav__link:hover{color:#ff7b7b}@media only screen and (max-width: 992px){.top-nav{display:none}}.mobile-nav .nav__list .nav__item{display:block;margin-bottom:36px;text-align:center}.mobile-nav .nav__list .nav__item:last-child{margin-bottom:0}.mobile-nav .nav__list .nav__item .nav__link{position:relative;font-size:18px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:#eee}.mobile-nav .nav__list .nav__item .nav__link:hover{color:#ff7b7b}@media only screen and (max-width: 576px){.mobile-nav .nav__list .nav__item{margin-bottom:28px}}.nav-buttons{display:flex;align-items:center;font-size:24px;color:#eee}.nav-buttons .search-button{display:flex;align-items:center;cursor:pointer;transition:all 0.2s}.nav-buttons .search-button span{transition:all 0.2s}.nav-buttons .search-button:hover span{color:#ff7b7b}.nav-buttons .search-button span{display:block;margin-left:8px;font-size:14px;font-weight:700;letter-spacing:1px;text-transform:uppercase}@media only screen and (max-width: 992px){.nav-buttons .search-button span{display:none}}.nav-buttons .nav__icon-menu{display:none;margin-left:20px}@media only screen and (max-width: 992px){.nav-buttons .nav__icon-menu{display:block}}.nav-buttons .nav__icon{cursor:pointer}.menu-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:100;opacity:0;visibility:hidden;background-color:#09080f;transition:all 0.5s ease-in-out}.menu-overlay.is-open{opacity:1;visibility:visible}@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none){.menu-overlay{-webkit-backdrop-filter:saturate(180%) blur(24px);backdrop-filter:saturate(180%) blur(24px);background-color:rgba(9,8,15,0.9)}}@media only screen and (min-width: 992px){.menu-overlay{display:none}}.nav-grid{width:100%;height:75vh;overflow-y:auto}.nav-grid__item{margin-bottom:30px}@media only screen and (max-width: 768px){.nav-grid__item{height:auto}}.nav-grid__title{position:relative;margin-bottom:48px;padding-bottom:15px;font-size:40px;text-align:center;color:#eee}.nav-grid__title::after{content:"";position:absolute;left:50%;bottom:0;transform:translate(-50%, -50%);display:block;width:25px;height:2px;background-color:#fff}@media only screen and (max-width: 768px){.nav-grid__title{margin-bottom:30px}}.search{position:fixed;top:0;left:0;right:0;bottom:0;z-index:100;overflow:auto;opacity:0;visibility:hidden;background-color:#09080f;transition:all 0.5s ease-in-out}.search.is-visible{opacity:1;visibility:visible}@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none){.search{-webkit-backdrop-filter:saturate(180%) blur(24px);backdrop-filter:saturate(180%) blur(24px);background-color:rgba(9,8,15,0.9)}}.search__box{position:relative;max-width:540px;width:100%;margin:0 auto;padding-top:140px}.search__box .search__close{position:absolute;top:50%;right:24px;transform:translateY(-50%);font-size:30px;line-height:1;color:rgba(238,238,238,0.5);transition:all .25s;cursor:pointer}.search__box .search__close:hover{color:#eee}@media only screen and (max-width: 768px){.search__box{width:80%;padding-top:100px}}@media only screen and (max-width: 576px){.search__box{width:90%}}.search__group{position:relative;margin-bottom:64px}.search__group .search__text{width:100%;height:auto;padding:16px 24px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:24px;font-weight:900;line-height:42px;border-radius:8px;border:4px solid rgba(238,238,238,0.1);transition:all .3s;color:#fff;background-color:transparent}.search__group .search__text::-webkit-input-placeholder{font-weight:900;color:rgba(238,238,238,0.8)}.search__group .search__text::placeholder{font-weight:900;color:rgba(238,238,238,0.8)}.search__group .search__text::-ms-clear{display:none}.search__group .search__text:focus{color:#eee;background:#09080f}@media only screen and (max-width: 576px){.search__group .search__text{font-size:26px}}.search-results-list .no-results{width:100%;list-style:none}.search-results-list .no-results h3{font-size:28px;text-align:center}.load-more{margin:0 auto}.load-more-section{margin:30px auto;text-align:center}@media only screen and (max-width: 576px){.load-more-section{margin:20px auto}}.footer-widgets{padding:64px 0 32px}.footer-widgets .row .col{flex-grow:1}@media only screen and (max-width: 768px){.footer-widgets{padding:48px 0 0}}.widget{margin-bottom:40px}@media only screen and (max-width: 768px){.widget{margin-bottom:64px}}.widget__title{position:relative;padding-left:8px;margin-bottom:36px;font-size:24px;line-height:1;color:#fff}.widget__title::after{content:"";position:absolute;left:0;top:50%;z-index:-1;transform:translateY(-50%);display:block;width:106px;height:38px;border-radius:4px 0px 0px 4px;background:linear-gradient(90deg, #ff7b7b -5.19%, rgba(15,14,21,0) 100%)}@media only screen and (max-width: 992px){.widget__title{font-size:24px}}.recent-posts{display:flex;align-items:center;margin-bottom:20px}.recent-posts:last-child{margin-bottom:0}@media only screen and (max-width: 360px){.recent-posts{flex-wrap:wrap;margin-bottom:32px}}.recent-posts__image{position:relative;display:block;width:100%;max-width:135px;height:144px;margin-right:20px;border-radius:16px;overflow:hidden;background:#09080f}.recent-posts__image img{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:16px;object-fit:cover}@media only screen and (max-width: 360px){.recent-posts__image{height:auto;max-width:100%;padding-top:56.6%;margin:0 0 20px}}.recent-posts__content .recent-posts__title{font-size:18px;margin:8px 0}.recent-posts__content .article__author-image{width:28px;height:28px}.tag__cloud{display:flex;flex-wrap:wrap}.tag__cloud a{display:inline-block;padding:6px 9px;margin:0 5px 5px 0;font-size:14px;line-height:14px;font-weight:500;text-transform:lowercase;border:2px solid rgba(255,255,255,0.4);border-radius:24px;color:#aaa;word-break:keep-all}.tag__cloud a:hover{border-color:#ff7b7b;color:#fff}.subscribe-subtitle{width:100%;margin-bottom:24px;font-size:16px;line-height:24px;color:#aaa}.subscribe-group-top{display:flex;align-items:center}.subscribe-group-top .subscribe-email{position:relative;width:100%;height:56px;padding:20px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:14px;line-height:20px;font-weight:700;border-radius:8px;color:#fff;background-color:#17151E;border:2px solid transparent;outline:0;-webkit-appearance:none;box-sizing:border-box;transition:border-color .2s ease-in-out;cursor:text}.subscribe-group-top .subscribe-email::placeholder{color:#eee}.subscribe-group-top .subscribe-email:focus{color:#fff;border-color:#ff7b7b}.subscribe-group-top .subscribe-button{margin-left:10px}.footer{position:relative;padding:64px 0;border-top:2px solid #09080f}.footer .footer__inner{display:flex;justify-content:space-between;align-items:center}@media only screen and (max-width: 992px){.footer .footer__inner{flex-direction:column}.footer .footer__inner .copyright{order:1}}@media only screen and (max-width: 768px){.footer .footer__inner{align-items:flex-start}}.copyright{font-size:15px;color:#aaa}.copyright a{font-weight:500;color:#fff}.copyright a:hover{color:#ff7b7b}.social{text-align:center}.social .social__list{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.social .social__item{display:inline-block;margin-left:8px}.social .social__item:first-child{margin-left:0}.social .social__link{display:flex;justify-content:center;align-items:center;width:40px;height:40px;font-size:20px;line-height:40px;border-radius:8px;color:#fff}.social .social__link:hover{color:#ff7b7b}@media only screen and (max-width: 992px){.social{margin-bottom:5px}.social .social__item{margin-bottom:10px}}.button{display:inline-block;white-space:nowrap;vertical-align:middle;font:inherit;border:none;border-radius:8px;outline:none;-webkit-appearance:none;text-align:center;text-decoration:none;color:#fff;transition:all 0.2s ease;cursor:pointer}.button:hover{color:#fff}.button--primary{padding:20px 40px;font-size:16px;font-weight:700;line-height:1;background-color:#17151E}.button--primary:hover{color:#09080f;background-color:#ff6262}.button--middle{position:relative;padding:24px 48px;width:100%;max-width:412px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:12px;font-weight:700;letter-spacing:1px;text-transform:uppercase;transition:all .2s ease;background-color:#09080f}.button--middle:hover{background-color:#17151E}.button--big{display:block;width:100%}.article{align-items:stretch;flex-grow:1;min-height:340px;margin-bottom:32px;transition:transform .2s ease}.article::after{content:"";display:table;padding-top:25%}.article--big::after{padding-top:35%}@media only screen and (max-width: 992px){.article--big::after{padding-top:25%}}@media only screen and (max-width: 576px){.article{min-height:280px}}.article__inner{position:relative;display:flex;width:100%;height:100%;border-radius:16px;overflow:hidden;box-shadow:0 5px 10px 0 rgba(0,0,0,0.5);background-color:#09080f}.article__inner .featured-post{position:absolute;top:20px;right:20px;z-index:10;padding:4px 6px;font-size:20px;border-radius:4px;color:#aaa;background:rgba(255,255,255,0.08);pointer-events:none}@media only screen and (max-width: 576px){.article__inner .featured-post{right:20px}}.article__title{margin:12px 0 12px;font-size:28px;line-height:1}.article__title a{color:#eee}@media only screen and (max-width: 576px){.article__title{font-size:24px}}.article__excerpt{margin-bottom:12px;font-size:14px;line-height:17px;color:#aaa}@media only screen and (max-width: 576px){.article__excerpt{font-size:13px}}.article__image{position:absolute;display:block;width:100%;height:100%;overflow:hidden;user-select:none;background-color:#09080f}.article__image::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(0deg, rgba(0,0,0,0.98) 0%, rgba(0,0,0,0.02) 100%, rgba(255,255,255,0.725928) 100%);pointer-events:none}.article__image a,.article__image img{position:absolute;top:0;width:100%;height:100%;object-fit:cover;border-radius:16px;pointer-events:none}.article__content{z-index:1;width:100%;margin-top:auto;padding:0 32px 32px;pointer-events:none}@media only screen and (max-width: 576px){.article__content{padding:20px}}.article__meta{line-height:14px}.article__meta .article__date,.article__meta .article__minutes{font-size:14px;line-height:1;font-weight:500}.article__bottom{display:flex;font-size:14px;font-weight:500;color:#fff}.article__bottom a{pointer-events:all}.article__bottom-meta{padding-top:2px}.article-tags .article__tag{display:inline-block;padding:6px 9px;margin:2px 0;font-size:14px;line-height:12px;font-weight:500;text-transform:lowercase;letter-spacing:-0.5px;border:2px solid #fff;border-radius:24px;color:#fff;word-break:keep-all}.article-tags .article__tag:hover{color:#fff;border-color:#ff7b7b}.article__author{float:left;flex-shrink:0}.article__author-image{position:relative;display:inline-block;width:36px;height:36px;padding:3px;margin-right:8px;border:2px solid #ff7b7b;border-radius:50%;overflow:hidden}.article__author-image img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.article__author-link{font-size:14px;color:#fff}.article__author-link:hover{color:#fff}.article__author span{color:rgba(255,255,255,0.8)}.post,.page{position:relative;max-width:760px;margin:0 auto}.post-head{margin-bottom:64px}.post-head .row{align-items:center}.post-head .post-head__box{margin-left:32px}.post-head .no-image.row{display:block}.post-head .no-image .post-head__box{position:relative;max-width:760px;margin:0 auto}@media only screen and (max-width: 992px){.post-head .post-head__box{margin-left:16px}}@media only screen and (max-width: 768px){.post-head{margin-bottom:40px}.post-head .post-head__box{margin-left:0}.post-head .row{flex-direction:column}}.post-image{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:16px;object-fit:cover}.image-box{position:relative;padding-top:90%;min-height:280px;border-radius:16px;overflow:hidden;box-shadow:0 5px 10px 0px rgba(0,0,0,0.15);background-color:#09080f}@media only screen and (max-width: 768px){.image-box{padding-top:65%;margin-bottom:40px}}.post__meta{line-height:13px}.post__meta .post__date,.post__meta .post__minutes{line-height:1;font-weight:500}.post__title{margin:20px 0 20px;font-size:56px;line-height:1}@media only screen and (max-width: 1200px){.post__title{font-size:40px}}@media only screen and (max-width: 576px){.post__title{font-size:32px}}.post__bottom{display:flex;font-size:14px;line-height:40px;font-weight:500;color:#fff}.post-tags .post__tag{padding:6px 9px;margin:2px 0;font-size:14px;line-height:14px;font-weight:500;border:2px solid #eee;border-radius:24px;color:#eee;word-break:keep-all}.post-tags .post__tag:hover{color:#fff;border-color:#ff7b7b}.post__author{float:left;flex-shrink:0}.post__author-image{position:relative;display:inline-block;width:36px;height:36px;padding:3px;margin-right:8px;border:2px solid #ff7b7b;border-radius:50%;overflow:hidden}.post__author-image img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.post__author-link{font-size:14px;color:#fff}.post__author-link:hover{color:#fff}.post__author span{color:rgba(255,255,255,0.8)}.post__content,.page__content{color:#eee;word-wrap:break-word;margin-bottom:80px}.post__content a,.page__content a{border-bottom:1px solid rgba(238,238,238,0.3);color:#fff}.post__content a:hover,.page__content a:hover{color:#ff7b7b;border-color:#ff7b7b;text-decoration:none}.post__content p code,.post__content p kbd,.post__content p samp,.post__content li code,.post__content li kbd,.post__content li samp,.page__content p code,.page__content p kbd,.page__content p samp,.page__content li code,.page__content li kbd,.page__content li samp{font-size:14px;font-family:Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace}.post__content table td code,.post__content table td kbd,.post__content table td samp,.page__content table td code,.page__content table td kbd,.page__content table td samp{font-size:12px}.post__content pre,.page__content pre{background-color:#17151E}.post__content h1 code,.post__content h2 code,.post__content h3 code,.post__content h4 code,.post__content h5 code,.post__content h6 code,.page__content h1 code,.page__content h2 code,.page__content h3 code,.page__content h4 code,.page__content h5 code,.page__content h6 code{font-size:85%}.post__content img,.page__content img{background-color:#fff;margin:0 auto;display:block}.post__content>ul,.page__content>ul{margin-left:40px}.post__content div.mermaid,.page__content div.mermaid{text-align:center;border-radius:16px;background-color:#17151E;padding:16px}.post__share{display:flex;justify-content:center;margin:64px 0}.post__share .share__list{display:inline-flex;justify-content:center;align-items:center;border-radius:16px;background:#17151E}.post__share .share__list .share__link{position:relative;display:flex;justify-content:center;align-items:center;padding:28px 24px;font-size:20px;color:#eee;transition:all .2s}.post__share .share__list .share__link:first-child{padding-left:48px}.post__share .share__list .share__link:first-child::after{content:none}.post__share .share__list .share__link:last-child{padding-right:48px}.post__share .share__list .share__link::after{content:"";position:absolute;left:0;display:block;width:1px;height:12px;background:rgba(238,238,238,0.08)}.post__share .share__list .share__link:hover{color:#ff7b7b}@media only screen and (max-width: 576px){.post__share{margin:48px 0}.post__share .share__list .share__link{padding:24px 20px}.post__share .share__list .share__link:first-child{padding-left:40px}.post__share .share__list .share__link:last-child{padding-right:40px}}.post__navigation{display:flex;justify-content:space-between;margin-bottom:64px;box-shadow:0 5px 10px 0 rgba(0,0,0,0.5);border-radius:16px}.post__navigation .prev,.post__navigation .prev img{border-radius:16px 0 0 16px}.post__navigation .next,.post__navigation .next img{border-radius:0 16px 16px 0}.post__navigation .prev,.post__navigation .next{position:relative;display:flex;align-items:flex-end;width:100%;min-height:240px;padding:0 32px 32px;overflow:hidden;background-size:cover;background-position:center;background-repeat:no-repeat;user-select:none}.post__navigation .prev::after,.post__navigation .next::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(0deg, rgba(0,0,0,0.98) 0%, rgba(0,0,0,0.02) 100%, rgba(255,255,255,0.725928) 100%);pointer-events:none;transition:.25s}.post__navigation .prev .post__nav,.post__navigation .next .post__nav{display:inline-block;margin-bottom:8px;font-size:12px;font-weight:500;text-transform:uppercase;color:#eee}.post__navigation .prev .post__nav-image,.post__navigation .next .post__nav-image{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.post__navigation .prev .post__nav-box,.post__navigation .next .post__nav-box{position:relative;z-index:1;width:100%}.post__navigation .prev .post__nav__prev i,.post__navigation .next .post__nav__prev i{margin-right:4px}.post__navigation .prev .post__nav__next i,.post__navigation .next .post__nav__next i{margin-left:4px}.post__navigation .prev .post__nav__title,.post__navigation .next .post__nav__title{margin-bottom:0;font-size:24px;line-height:1}.post__navigation .prev .post__nav__title a,.post__navigation .next .post__nav__title a{color:#eee}.post__navigation .next{text-align:right;margin-left:auto}@media only screen and (max-width: 768px){.post__navigation{flex-wrap:wrap;box-shadow:none}.post__navigation .prev,.post__navigation .next{width:100%;border-radius:16px;box-shadow:0 5px 10px 0 rgba(0,0,0,0.5)}.post__navigation .prev img,.post__navigation .next img{border-radius:16px}.post__navigation .prev{margin-bottom:20px}}@media only screen and (max-width: 576px){.post__navigation{margin-bottom:48px}}.related-posts{display:none}.related-posts.is-related{display:block}.related-posts .related-title{position:relative;padding-left:8px;margin-bottom:36px;font-size:24px;line-height:1;color:#fff}.related-posts .related-title::after{content:"";position:absolute;left:0;top:50%;z-index:-1;transform:translateY(-50%);display:block;width:106px;height:38px;border-radius:4px 0px 0px 4px;background:linear-gradient(90deg, #ff7b7b -5.19%, rgba(15,14,21,0) 100%)}@media only screen and (max-width: 992px){.related-posts .related-title{font-size:24px}}.disqus-inner{border-radius:16px;background:#17151E}.post-comments{max-width:824px;padding:64px 32px;margin:0 auto}@media only screen and (max-width: 576px){.post-comments{padding:48px 32px}}.archive-box{position:relative;margin:50px 0 80px;text-align:center}@media only screen and (max-width: 576px){.archive-box{margin:20px 0 50px}}.archive-meta{font-size:16px;color:rgba(238,238,238,0.6)}.archive-title{position:relative;margin:0;font-size:47px;line-height:57px;text-transform:lowercase}@media only screen and (max-width: 576px){.archive-title{font-size:40px;line-height:52px}}.archive-description{max-width:600px;margin:10px auto 0;font-size:16px;line-height:32px}@media only screen and (max-width: 576px){.archive-description{margin:5px auto 0;line-height:28px}}.contact-form .form__group{margin-bottom:20px}.contact-form .form__input{width:100%;padding:20px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:16px;font-weight:700;border:2px solid transparent;border-radius:8px;color:#eee;background:#17151E;transition:border-color .2s ease-in-out}.contact-form .form__input::placeholder{color:#fff}.contact-form .form__input:focus{border-color:#ff7b7b}.contact-form textarea{resize:vertical}.contact-form button[type="submit"]{border-radius:10px;will-change:transform;transition:all .1s ease;cursor:pointer;color:#fff;outline:none;text-align:center}.contact-form button.submitting[type="submit"]{cursor:wait;font-size:0;padding:0;width:50px;height:50px;border-radius:25px;background:transparent;border:2px solid #ff7b7b;border-right:2px solid #fff;animation:loader .4s linear infinite}@keyframes loader{0%{transform:rotateZ(0)}100%{transform:rotateZ(360deg)}}.contact-form .message-sent{text-align:center;display:none}.cv .timeline{position:relative;margin:3em 0}.cv .timeline:before{content:'';position:absolute;top:8px;left:50%;margin-left:2px;width:2px;height:100%;background:#aaa;z-index:1;left:8px;width:2px}.cv .timeline:after{content:'';border-bottom:2px solid #aaa;width:22px;display:block;top:9px;position:relative}.cv .timeline-block{display:block;margin-bottom:2.5em;padding-left:2.5em}.cv .marker{width:25px;height:25px;border-radius:100%;border:2px solid #ff7b7b;background:#ff7b7b;z-index:99;display:block;position:absolute;left:-1px;margin-top:6px}.cv .timeline-content h3{margin-bottom:0px;font-size:1.4em;font-weight:500}.cv .timeline-content span{font-size:1em;display:block}.cv .timeline-content span.contractor{display:inline;color:#fff;font-size:10px;margin-left:.3em;position:relative;top:-4px}.cv .timeline-content span.contractor:before{content:'contract';border:1px solid #fff;background-color:#09080f;border-radius:1em;padding:2px 7px;vertical-align:middle;letter-spacing:0.5px;text-transform:uppercase}.cv .timeline-content p{margin-bottom:0px}.cv .timeline-content p.company-summary{margin-top:1em}.cv .timeline-content p.company-name,.cv .timeline-content p.date{color:#fff}.cv .timeline-content ul{padding:1em 0 0 1em}.cv .timeline-content ul li{margin-bottom:.4em}@media only screen and (max-width: 800px){.cv .marker{width:17px;height:17px;left:3px}.cv .timeline-block{padding-left:2em}.cv .timeline-content h3{font-size:1.3em}}@media only screen and (max-width: 600px){.cv .timeline-content h3{font-size:1.25em}}.page__content .about__author{text-align:center}.page__content .about__author-image{position:relative;display:inline-block;width:200px;height:200px;padding:3px;margin-bottom:30px;border:2px solid #ff7b7b;border-radius:50%;overflow:hidden;background-color:transparent}

  </style>
</head>

<body>

  

<!-- begin header -->
<header class="header ">
  <div class="container">
    <div class="row">
      <div class="header__inner col col-12">

      <div class="logo">
        <a class="logo__link" href="/">
        
          cassiomolin
        
        </a>
      </div>
        
      <div class="menu-overlay">
        <nav class="main-nav">
          <div class="main-nav__box">
            <div class="nav__icon-close">
              <i class="lni lni-close"></i>
            </div>
            <div class="nav-grid">
              <div class="nav-grid__item">
                <h2 class="nav-grid__title">Menu</h2>
                <div class="mobile-nav">
                  <ul class="nav__list list-reset">
  <li class="nav__item">
    <a href="/" class="nav__link">Home</a>
  </li>
  
    
  
    
      
      <li class="nav__item">
        <a href="/about/" class="nav__link">About</a>
      </li>
      
    
  
    
      
    
  
    
      
      <li class="nav__item">
        <a href="/contact/" class="nav__link">Contact Me</a>
      </li>
      
    
  
    
      
      <li class="nav__item">
        <a href="/cv/" class="nav__link">CV</a>
      </li>
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
</ul>
                </div>
              </div>
            </div>
          </div>
        </nav>
      </div>

      <div class="navigation">
        <div class="top-nav">
          <ul class="nav__list list-reset">
  <li class="nav__item">
    <a href="/" class="nav__link">Home</a>
  </li>
  
    
  
    
      
      <li class="nav__item">
        <a href="/about/" class="nav__link">About</a>
      </li>
      
    
  
    
      
    
  
    
      
      <li class="nav__item">
        <a href="/contact/" class="nav__link">Contact Me</a>
      </li>
      
    
  
    
      
      <li class="nav__item">
        <a href="/cv/" class="nav__link">CV</a>
      </li>
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
</ul>
        </div>
      </div>

      <div class="nav-buttons">
        <div class="search-button">
          <i class="nav__icon nav__icon-search lni lni-search-alt"></i>
          <span>Search</span>
        </div>
        <i class="nav__icon nav__icon-menu lni lni-menu"></i>
      </div>

      </div>
    </div>
  </div>
</header>
<!-- end header -->

<!-- begin search -->
<div class="search">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="search__box">
          <div class="search__group">
            <div class="search__close">
              <i class="lni lni-close"></i>
            </div>
            <label for="js-search-input" class="screen-reader-text">Search for Blog</label>
            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="Type to search...">
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row search-results-list" id="js-results-container"></div>
  </div>

</div>
<!-- end search -->

  <!-- begin content -->
  <main class="content" aria-label="Content">
    <div class="post-head">
  <div class="container">
    <div class="row">
      
      <div class="col col-6 col-t-12">
        <div class="image-box">
          <img class="post-image lazy" data-src="/assets/images/posts/2019-06-10-using-http-patch-in-spring/cover.jpg" alt="Using HTTP PATCH in Spring">
        </div>
      </div>
      
  
      <div class="col col-6 col-t-12">
        <div class="post-head__box">
        
          <div class="post__meta">
            <span class="post__minutes">
              
              
                27 min read •
              
              <time class="post__date"
                datetime="2019-06-10T23:35:00+00:00">10 Jun 2019</time>
            </span>
          </div>
        
          <h2 class="post__title">Using HTTP PATCH in Spring</h2>
        
          <div class="post__bottom">
        
            <div class="post__author">
              <a href="/about/" aria-label="cassiomolin"><img class="post__author-image"
                  src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
            </div>
        
            <div class="post__bottom-meta">
              <a href="/about/" class="post__author-link">cassiomolin</a>
              
              <span>in</span>
              <span class="post-tags">
                
                <a href="/tag/java" class="post__tag">java</a>
                
                <a href="/tag/json" class="post__tag">json</a>
                
                <a href="/tag/jackson" class="post__tag">jackson</a>
                
                <a href="/tag/spring-boot" class="post__tag">spring-boot</a>
                
                <a href="/tag/javax-json" class="post__tag">javax-json</a>
                
                <a href="/tag/rest" class="post__tag">rest</a>
                
                <a href="/tag/http" class="post__tag">http</a>
                
                <a href="/tag/patch" class="post__tag">patch</a>
                
              </span>
              
            </div>
          </div>
        
        </div>
      </div>
    </div>
  </div>
</div>

<!-- begin post -->
<div class="container">
  <article class="post animate">

    <div class="post__content">
      <p>This post demonstrates an approach to support HTTP <code class="language-plaintext highlighter-rouge">PATCH</code> with <em>JSON Patch</em> and <em>JSON Merge Patch</em> for performing partial modifications to resources in Spring. As I have seen lots of misunderstanding on how <code class="language-plaintext highlighter-rouge">PATCH</code> works, I aim to clarify its usage before diving into the actual solution.</p>

<p>This post is heavy on code examples and the full source code is available on <a href="https://github.com/cassiomolin/http-patch-spring">GitHub</a>. I also have put together a <a href="https://github.com/cassiomolin/http-patch-spring/tree/master/misc/postman">Postman collection</a> so you can play around with the API.</p>

<!--more-->

<h5 class="no_toc" id="table-of-contents">Table of contents</h5>

<ul id="markdown-toc">
  <li><a href="#the-problem-with-put-and-the-need-for-patch" id="markdown-toc-the-problem-with-put-and-the-need-for-patch">The problem with <code class="language-plaintext highlighter-rouge">PUT</code> and the need for <code class="language-plaintext highlighter-rouge">PATCH</code></a></li>
  <li><a href="#describing-how-the-resource-will-be-modified" id="markdown-toc-describing-how-the-resource-will-be-modified">Describing how the resource will be modified</a>    <ul>
      <li><a href="#json-patch" id="markdown-toc-json-patch">JSON Patch</a></li>
      <li><a href="#json-merge-patch" id="markdown-toc-json-merge-patch">JSON Merge Patch</a></li>
    </ul>
  </li>
  <li><a href="#json-p-java-api-for-json-processing" id="markdown-toc-json-p-java-api-for-json-processing">JSON-P: Java API for JSON Processing</a></li>
  <li><a href="#parsing-the-request-payload" id="markdown-toc-parsing-the-request-payload">Parsing the request payload</a></li>
  <li><a href="#creating-the-controller-methods" id="markdown-toc-creating-the-controller-methods">Creating the controller methods</a></li>
  <li><a href="#applying-the-patch" id="markdown-toc-applying-the-patch">Applying the patch</a></li>
  <li><a href="#validating-the-patch" id="markdown-toc-validating-the-patch">Validating the patch</a></li>
  <li><a href="#bonus-decoupling-the-domain-model-from-the-api-model" id="markdown-toc-bonus-decoupling-the-domain-model-from-the-api-model">Bonus: Decoupling the domain model from the API model</a></li>
  <li><a href="#references" id="markdown-toc-references">References</a></li>
</ul>

<h2 id="the-problem-with-put-and-the-need-for-patch">The problem with <code class="language-plaintext highlighter-rouge">PUT</code> and the need for <code class="language-plaintext highlighter-rouge">PATCH</code></h2>

<p>Consider, for example, we are creating an API to manage contacts. On the server, we have a resource that can be represented with the following JSON document:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Appleseed"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"work"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Engineer"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"company"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Acme"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"phones"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mobile"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Let’s say that John has been promoted to senior engineer and we want to keep our contact list updated. We could modify this resource using a <code class="language-plaintext highlighter-rouge">PUT</code> request, as shown below:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PUT</span> <span class="nn">/contacts/1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.org</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Appleseed"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"work"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Senior Engineer"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"company"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Acme"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"phones"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000000000"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mobile"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>With <code class="language-plaintext highlighter-rouge">PUT</code>, however, we have to send the full representation of the resource even when we need to modify a <em>single</em> field of a resource, which may not be desirable in some situations.</p>

<p>Let’s have a look on how the <code class="language-plaintext highlighter-rouge">PUT</code> HTTP method is defined in the <a href="https://tools.ietf.org/html/rfc7231">RFC 7231</a>, one of the documents that currently define the HTTP/1.1 protocol:</p>

<blockquote class="long">
  <h4 class="no_toc" id="434--put"><a href="https://tools.ietf.org/html/rfc7231#section-4.3.4">4.3.4.  PUT</a></h4>

  <p>The <code class="language-plaintext highlighter-rouge">PUT</code> method requests that the state of the target resource be created or replaced with the state defined by the representation enclosed in the request message payload. […]</p>
</blockquote>

<p>So, as per definition, the <code class="language-plaintext highlighter-rouge">PUT</code> method is meant to be used for:</p>

<ul>
  <li><em>Creating</em> resources <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup></li>
  <li><em>Replacing</em> the state of a given resource</li>
</ul>

<p>The key here is: the <code class="language-plaintext highlighter-rouge">PUT</code> payload must be a <em>new representation of the resource</em>. Hence it’s not meant for performing <em>partial modifications</em> to resources at all. To fill this gap, the <code class="language-plaintext highlighter-rouge">PATCH</code> method was created and it is currently defined in the <a href="https://tools.ietf.org/html/rfc5789">RFC 5789</a>:</p>

<blockquote class="long">
  <h4 class="no_toc" id="2-the-patch-method"><a href="https://tools.ietf.org/html/rfc5789#section-2">2. The PATCH Method</a></h4>

  <p>The <code class="language-plaintext highlighter-rouge">PATCH</code> method requests that a set of changes described in the request entity be applied to the resource identified by the Request-URI. The set of changes is represented in a format called a “patch document” identified by a media type. […]</p>
</blockquote>

<p>The difference between the <code class="language-plaintext highlighter-rouge">PUT</code> and <code class="language-plaintext highlighter-rouge">PATCH</code> requests is reflected in the way the server processes the request payload to modify a given resource:</p>

<ul>
  <li>In a <code class="language-plaintext highlighter-rouge">PUT</code> request, the payload is a modified version of the resource stored on the server. And the client is requesting the stored version to be <em>replaced</em> with the new version.</li>
  <li>In a <code class="language-plaintext highlighter-rouge">PATCH</code> request, the request payload contains a <em>set of instructions</em> describing how a resource currently stored on the server should be modified to produce a new version.</li>
</ul>

<h2 id="describing-how-the-resource-will-be-modified">Describing how the resource will be modified</h2>

<p>The <code class="language-plaintext highlighter-rouge">PATCH</code> method definition, however, doesn’t enforce any format for the request payload apart from mentioning that the request payload should contain a set of instructions describing how the resource will be modified and that set of instructions is identified by a media type.</p>

<p>Let’s have a look at some formats for describing how a resource is to be <code class="language-plaintext highlighter-rouge">PATCH</code>ed:</p>

<h3 id="json-patch">JSON Patch</h3>

<p>JSON Patch is a format for expressing a sequence of operations to be applied to a JSON document. It is defined in the <a href="https://tools.ietf.org/html/rfc6902">RFC 6902</a> and is identified by the <code class="language-plaintext highlighter-rouge">application/json-patch+json</code> media type.</p>

<p>The JSON Patch document represents an array of objects and each object represents a single operation to be applied to the target JSON document.</p>

<p>The evaluation of a JSON Patch document begins against a target JSON document and the operations are applied sequentially in the order they appear in the array. Each operation in the sequence is applied to the target document and the resulting document becomes the target of the next operation. The evaluation continues until all operations are successfully applied or until an error condition is encountered.</p>

<p>The operation objects must have exactly one <code class="language-plaintext highlighter-rouge">op</code> member, whose value indicates the operation to perform:</p>

<table>
  <thead>
    <tr>
      <th>Operation</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://tools.ietf.org/html/rfc6902#section-4.1"><code class="language-plaintext highlighter-rouge">add</code></a></td>
      <td>Adds the value at the target location; if the value exists in the given location, it’s replaced</td>
    </tr>
    <tr>
      <td><a href="https://tools.ietf.org/html/rfc6902#section-4.2"><code class="language-plaintext highlighter-rouge">remove</code></a></td>
      <td>Removes the value at the target location</td>
    </tr>
    <tr>
      <td><a href="https://tools.ietf.org/html/rfc6902#section-4.3"><code class="language-plaintext highlighter-rouge">replace</code></a></td>
      <td>Replaces the value at the target location</td>
    </tr>
    <tr>
      <td><a href="https://tools.ietf.org/html/rfc6902#section-4.4"><code class="language-plaintext highlighter-rouge">move</code></a></td>
      <td>Removes the value at a specified location and adds it to the target location</td>
    </tr>
    <tr>
      <td><a href="https://tools.ietf.org/html/rfc6902#section-4.5"><code class="language-plaintext highlighter-rouge">copy</code></a></td>
      <td>Copies the value at a specified location to the target location</td>
    </tr>
    <tr>
      <td><a href="https://tools.ietf.org/html/rfc6902#section-4.6"><code class="language-plaintext highlighter-rouge">test</code></a></td>
      <td>Tests that a value at the target location is equal to a specified value</td>
    </tr>
  </tbody>
</table>

<p>Any other values are considered errors.</p>

<p>A request to modify John’s job title could be:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PATCH</span> <span class="nn">/contacts/1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.org</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json-patch+json</span>

[
  { "op": "replace", "path": "/work/title", "value": "Senior Engineer" }
]
</code></pre></div></div>

<h3 id="json-merge-patch">JSON Merge Patch</h3>

<p>JSON Merge Patch is a format that describes the changes to be made to a target JSON document using a syntax that closely mimics the document being modified. It is defined in the <a href="https://tools.ietf.org/html/rfc7396">RFC 7396</a> is identified by the <code class="language-plaintext highlighter-rouge">application/merge-patch+json</code> media type.</p>

<p>The server processing a JSON Merge Patch document determine the exact set of changes being requested by comparing the content of the provided patch against the current content of the target document:</p>

<ul>
  <li>If the merge patch contains members that do not appear within the target document, those members are <em>added</em></li>
  <li>If the target does contain the member, the value is <em>replaced</em></li>
  <li><em>null</em> values in the merge patch indicate that existing values in the target document are to be <em>removed</em></li>
  <li>Other values in the target document will remain <em>untouched</em></li>
</ul>

<p>A request to modify John’s job title could be:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">PATCH</span> <span class="nn">/contacts/1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.org</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/merge-patch+json</span>

{
  "work": {
    "title": "Senior Engineer"
  }
}
</code></pre></div></div>

<h2 id="json-p-java-api-for-json-processing">JSON-P: Java API for JSON Processing</h2>

<p><em>JSON-P</em> 1.0, defined in the JSR 353 and also known as <em>Java API for JSON Processing</em> 1.0, brought official support for JSON processing in Java EE. JSON-P 1.1, defined in the JSR 374, introduced support for JSON Patch and JSON Merge Patch formats to Java EE.</p>

<p>Let’s have a quick look at the API to start getting familiar with it:</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/Json.html"><code class="language-plaintext highlighter-rouge">Json</code></a></td>
      <td>Factory class for creating JSON processing objects</td>
    </tr>
    <tr>
      <td><a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonPatch.html"><code class="language-plaintext highlighter-rouge">JsonPatch</code></a></td>
      <td>Represents an implementation of JSON Patch</td>
    </tr>
    <tr>
      <td><a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonMergePatch.html"><code class="language-plaintext highlighter-rouge">JsonMergePatch</code></a></td>
      <td>Represents an implementation of JSON Merge Patch</td>
    </tr>
    <tr>
      <td><a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonValue.html"><code class="language-plaintext highlighter-rouge">JsonValue</code></a></td>
      <td>Represents an immutable JSON value that can be an <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonObject.html"><em>object</em></a>, an <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonArray.html"><em>array</em></a>, a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonNumber.html"><em>number</em></a>, a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonString.html"><em>string</em></a>, <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonValue.html#TRUE"><em><code class="language-plaintext highlighter-rouge">true</code></em></a>, <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonValue.html#FALSE"><em><code class="language-plaintext highlighter-rouge">false</code></em></a> or <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonValue.html#NULL"><em><code class="language-plaintext highlighter-rouge">null</code></em></a></td>
    </tr>
    <tr>
      <td><a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonStructure.html"><code class="language-plaintext highlighter-rouge">JsonStructure</code></a></td>
      <td>Super type for the two structured types in JSON: <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonObject.html"><em>object</em></a> and <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonArray.html"><em>array</em></a></td>
    </tr>
  </tbody>
</table>

<p>To patch using JSON Patch, we would have the following:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Target JSON document to be patched</span>
<span class="nc">JsonObject</span> <span class="n">target</span> <span class="o">=</span> <span class="o">...;</span>

<span class="c1">// Create JSON Patch document</span>
<span class="nc">JsonPatch</span> <span class="n">jsonPatch</span> <span class="o">=</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createPatchBuilder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"/work/title"</span><span class="o">,</span> <span class="s">"Senior Engineer"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="c1">// Apply the patch to the target document</span>
<span class="nc">JsonValue</span> <span class="n">patched</span> <span class="o">=</span> <span class="n">jsonPatch</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">target</span><span class="o">);</span>
</code></pre></div></div>

<p>And to patch using JSON Merge Patch, we would have the following:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Target JSON document to be patched</span>
<span class="nc">JsonObject</span> <span class="n">target</span> <span class="o">=</span> <span class="o">...;</span>

<span class="c1">// Create JSON Merge Patch document</span>
<span class="nc">JsonMergePatch</span> <span class="n">mergePatch</span> <span class="o">=</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createMergePatch</span><span class="o">(</span><span class="nc">Json</span><span class="o">.</span><span class="na">createObjectBuilder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"work"</span><span class="o">,</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createObjectBuilder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"title"</span><span class="o">,</span> <span class="s">"Senior Engineer"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">build</span><span class="o">());</span>

<span class="c1">// Apply the patch to the target document</span>
<span class="nc">JsonValue</span> <span class="n">patched</span> <span class="o">=</span> <span class="n">mergePatch</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">target</span><span class="o">);</span>
</code></pre></div></div>

<p>Having said that, let me highlight that JSON-P is just an API, that is, a set of interfaces. If we want to work with it, we need an <em>implementation</em> such as <a href="https://johnzon.apache.org/">Apache Johnzon</a>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.johnzon<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>johnzon-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${johnzon.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h2 id="parsing-the-request-payload">Parsing the request payload</h2>

<p>To parse a <code class="language-plaintext highlighter-rouge">PATCH</code> request payload, we must take the following into account:</p>

<ul>
  <li>For an incoming request with the <code class="language-plaintext highlighter-rouge">application/json-patch+json</code> content type, the payload must be converted to an instance of <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonPatch.html"><code class="language-plaintext highlighter-rouge">JsonPatch</code></a>.</li>
  <li>For an incoming request with the <code class="language-plaintext highlighter-rouge">application/merge-patch+json</code> content type, the payload must be converted to an instance of <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonMergePatch.html"><code class="language-plaintext highlighter-rouge">JsonMergePatch</code></a>.</li>
</ul>

<p>Spring MVC, however, doesn’t know how to create instances of <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonPatch.html"><code class="language-plaintext highlighter-rouge">JsonPatch</code></a> and <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonMergePatch.html"><code class="language-plaintext highlighter-rouge">JsonMergePatch</code></a>. So we need to provide a custom <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/http/converter/HttpMessageConverter.html"><code class="language-plaintext highlighter-rouge">HttpMessageConverter&lt;T&gt;</code></a> for each type. Fortunately it’s pretty straightforward.</p>

<p>For convenience, let’s extend <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/http/converter/AbstractHttpMessageConverter.html"><code class="language-plaintext highlighter-rouge">AbstractHttpMessageConverter&lt;T&gt;</code></a> and annotate the implementation with <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/stereotype/Component.html"><code class="language-plaintext highlighter-rouge">@Component</code></a>, so Spring can pick it up:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JsonPatchHttpMessageConverter</span> <span class="kd">extends</span> <span class="nc">AbstractHttpMessageConverter</span><span class="o">&lt;</span><span class="nc">JsonPatch</span><span class="o">&gt;</span> <span class="o">{</span>
   <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The constructor will invoke the parent’s constructor indicating the supported media type for this converter:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">JsonPatchHttpMessageConverter</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">"application/json-patch+json"</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We indicate that our converter supports the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonPatch.html"><code class="language-plaintext highlighter-rouge">JsonPatch</code></a> class:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">JsonPatch</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Then we implement the method that will read the HTTP request payload and convert it to a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonPatch.html"><code class="language-plaintext highlighter-rouge">JsonPatch</code></a> instance:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="nc">JsonPatch</span> <span class="nf">readInternal</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">JsonPatch</span><span class="o">&gt;</span> <span class="n">clazz</span><span class="o">,</span> <span class="nc">HttpInputMessage</span> <span class="n">inputMessage</span><span class="o">)</span>
        <span class="kd">throws</span> <span class="nc">HttpMessageNotReadableException</span> <span class="o">{</span>

    <span class="k">try</span> <span class="o">(</span><span class="nc">JsonReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createReader</span><span class="o">(</span><span class="n">inputMessage</span><span class="o">.</span><span class="na">getBody</span><span class="o">()))</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createPatch</span><span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">readArray</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">HttpMessageNotReadableException</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">inputMessage</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>It’s unlikely we’ll need to write <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonPatch.html"><code class="language-plaintext highlighter-rouge">JsonPatch</code></a> instances to the responses, but we could implement it as follows:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">writeInternal</span><span class="o">(</span><span class="nc">JsonPatch</span> <span class="n">jsonPatch</span><span class="o">,</span> <span class="nc">HttpOutputMessage</span> <span class="n">outputMessage</span><span class="o">)</span>
        <span class="kd">throws</span> <span class="nc">HttpMessageNotWritableException</span> <span class="o">{</span>

    <span class="k">try</span> <span class="o">(</span><span class="nc">JsonWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createWriter</span><span class="o">(</span><span class="n">outputMessage</span><span class="o">.</span><span class="na">getBody</span><span class="o">()))</span> <span class="o">{</span>
        <span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">jsonPatch</span><span class="o">.</span><span class="na">toJsonArray</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">HttpMessageNotWritableException</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The message converter for <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonMergePatch.html"><code class="language-plaintext highlighter-rouge">JsonMergePatch</code></a> is pretty much the same as the converter described above (except for the types handled by the converter):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JsonMergePatchHttpMessageConverter</span> <span class="kd">extends</span> <span class="nc">AbstractHttpMessageConverter</span><span class="o">&lt;</span><span class="nc">JsonMergePatch</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">JsonMergePatchHttpMessageConverter</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">"application/merge-patch+json"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">JsonMergePatch</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">JsonMergePatch</span> <span class="nf">readInternal</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">JsonMergePatch</span><span class="o">&gt;</span> <span class="n">clazz</span><span class="o">,</span> <span class="nc">HttpInputMessage</span> <span class="n">inputMessage</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">HttpMessageNotReadableException</span> <span class="o">{</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">JsonReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createReader</span><span class="o">(</span><span class="n">inputMessage</span><span class="o">.</span><span class="na">getBody</span><span class="o">()))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createMergePatch</span><span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">readValue</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">HttpMessageNotReadableException</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">inputMessage</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">writeInternal</span><span class="o">(</span><span class="nc">JsonMergePatch</span> <span class="n">jsonMergePatch</span><span class="o">,</span> <span class="nc">HttpOutputMessage</span> <span class="n">outputMessage</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">HttpMessageNotWritableException</span> <span class="o">{</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">JsonWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="nc">Json</span><span class="o">.</span><span class="na">createWriter</span><span class="o">(</span><span class="n">outputMessage</span><span class="o">.</span><span class="na">getBody</span><span class="o">()))</span> <span class="o">{</span>
            <span class="n">writer</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">jsonMergePatch</span><span class="o">.</span><span class="na">toJsonValue</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">HttpMessageNotWritableException</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="creating-the-controller-methods">Creating the controller methods</h2>

<p>With the HTTP message converters in place, we can receive <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonPatch.html"><code class="language-plaintext highlighter-rouge">JsonPatch</code></a> and <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonMergePatch.html"><code class="language-plaintext highlighter-rouge">JsonMergePatch</code></a> as method arguments in our controller methods, annotated with <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestBody.html"><code class="language-plaintext highlighter-rouge">@RequestBody</code></a>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PatchMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span> <span class="n">consumes</span> <span class="o">=</span> <span class="s">"application/json-patch+json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">updateContact</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
                                          <span class="nd">@RequestBody</span> <span class="nc">JsonPatch</span> <span class="n">patchDocument</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PatchMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span> <span class="n">consumes</span> <span class="o">=</span> <span class="s">"application/merge-patch+json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">updateContact</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
                                          <span class="nd">@RequestBody</span> <span class="nc">JsonMergePatch</span> <span class="n">mergePatchDocument</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="applying-the-patch">Applying the patch</h2>

<p>It is worth it to mention that both JSON Patch and JSON Merge Patch operate over JSON documents.</p>

<p>So, to apply the patch to a Java bean, we first need to convert the Java bean to a JSON-P type, such as <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonStructure.html"><code class="language-plaintext highlighter-rouge">JsonStructure</code></a> or <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonValue.html"><code class="language-plaintext highlighter-rouge">JsonValue</code></a>. Then we apply the patch to it and convert the patched document back to a Java bean:</p>

<p><img src="/assets/images/posts/2019-06-10-using-http-patch-in-spring/diagram-patch-conversions.png" alt="Patch conversions" title="Patch conversions" /></p>

<p>These conversions could be handled by Jackson, which provides an <a href="https://github.com/FasterXML/jackson-datatype-jsr353">extension module</a> to work with JSON-P types. With this extension module, we can read JSON as <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonValue.html"><code class="language-plaintext highlighter-rouge">JsonValue</code></a>s and write <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/JsonValue.html"><code class="language-plaintext highlighter-rouge">JsonValue</code></a>s as JSON as part of normal Jackson processing, taking advantage of the powerful data-binding features that Jackson provides:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.datatype<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jackson-datatype-jsr353<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${jackson.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>With module extension dependency on the classpath, we can configure the <a href="https://fasterxml.github.io/jackson-databind/javadoc/2.9/com/fasterxml/jackson/databind/ObjectMapper.html"><code class="language-plaintext highlighter-rouge">ObjectMapper</code></a> and expose it as a Spring <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Bean.html"><code class="language-plaintext highlighter-rouge">@Bean</code></a> (so it can be picked up by String and can be injected in other Spring beans):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">ObjectMapper</span> <span class="nf">objectMapper</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">ObjectMapper</span><span class="o">()</span>
            <span class="o">.</span><span class="na">setDefaultPropertyInclusion</span><span class="o">(</span><span class="nc">Include</span><span class="o">.</span><span class="na">NON_NULL</span><span class="o">)</span>
            <span class="o">.</span><span class="na">disable</span><span class="o">(</span><span class="nc">DeserializationFeature</span><span class="o">.</span><span class="na">FAIL_ON_UNKNOWN_PROPERTIES</span><span class="o">)</span>
            <span class="o">.</span><span class="na">disable</span><span class="o">(</span><span class="nc">SerializationFeature</span><span class="o">.</span><span class="na">WRITE_DATES_AS_TIMESTAMPS</span><span class="o">)</span>
            <span class="o">.</span><span class="na">findAndRegisterModules</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The <a href="https://fasterxml.github.io/jackson-databind/javadoc/2.9/com/fasterxml/jackson/databind/ObjectMapper.html#findAndRegisterModules--"><code class="language-plaintext highlighter-rouge">findAndRegisterModules()</code></a> method is important here: it tells Jackson to search and register the any modules found in the classpath, including the <a href="https://github.com/FasterXML/jackson-datatype-jsr353"><code class="language-plaintext highlighter-rouge">jackson-datatype-jsr353</code></a> extension module. Alternatively, we can register the module manually:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mapper</span><span class="o">.</span><span class="na">registerModule</span><span class="o">(</span><span class="k">new</span> <span class="nc">JSR353Module</span><span class="o">());</span>
</code></pre></div></div>

<p>Once the <a href="https://fasterxml.github.io/jackson-databind/javadoc/2.9/com/fasterxml/jackson/databind/ObjectMapper.html"><code class="language-plaintext highlighter-rouge">ObjectMapper</code></a> is configured, we can inject it in our Spring beans and create a method to apply the JSON Patch to a Java bean:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">patch</span><span class="o">(</span><span class="nc">JsonPatch</span> <span class="n">patch</span><span class="o">,</span> <span class="no">T</span> <span class="n">targetBean</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">beanClass</span><span class="o">)</span> <span class="o">{</span>
    
    <span class="c1">// Convert the Java bean to a JSON document</span>
    <span class="nc">JsonStructure</span> <span class="n">target</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">targetBean</span><span class="o">,</span> <span class="nc">JsonStructure</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="c1">// Apply the JSON Patch to the JSON document</span>
    <span class="nc">JsonValue</span> <span class="n">patched</span> <span class="o">=</span> <span class="n">patch</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">target</span><span class="o">);</span>
    
    <span class="c1">// Convert the JSON document to a Java bean and return it</span>
    <span class="k">return</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">patched</span><span class="o">,</span> <span class="n">beanClass</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>And here’s the method to patch using JSON Merge Patch:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">mergePatch</span><span class="o">(</span><span class="nc">JsonMergePatch</span> <span class="n">mergePatch</span><span class="o">,</span> <span class="no">T</span> <span class="n">targetBean</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">beanClass</span><span class="o">)</span> <span class="o">{</span>
    
    <span class="c1">// Convert the Java bean to a JSON document</span>
    <span class="nc">JsonValue</span> <span class="n">target</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">targetBean</span><span class="o">,</span> <span class="nc">JsonValue</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="c1">// Apply the JSON Merge Patch to the JSON document</span>
    <span class="nc">JsonValue</span> <span class="n">patched</span> <span class="o">=</span> <span class="n">mergePatch</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">target</span><span class="o">);</span>
    
    <span class="c1">// Convert the JSON document to a Java bean and return it</span>
    <span class="k">return</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">patched</span><span class="o">,</span> <span class="n">beanClass</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>With this in place, the controller method implementation for JSON Patch could be like:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PatchMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span> <span class="n">consumes</span> <span class="o">=</span> <span class="s">"application/json-patch+json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">updateContact</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
                                          <span class="nd">@RequestBody</span> <span class="nc">JsonPatch</span> <span class="n">patchDocument</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// Find the model that will be patched</span>
    <span class="nc">Contact</span> <span class="n">contact</span> <span class="o">=</span> <span class="n">contactService</span><span class="o">.</span><span class="na">findContact</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElseThrow</span><span class="o">(</span><span class="nl">ResourceNotFoundException:</span><span class="o">:</span><span class="k">new</span><span class="o">);</span>
    
    <span class="c1">// Apply the patch</span>
    <span class="nc">Contact</span> <span class="n">contactPatched</span> <span class="o">=</span> <span class="n">patch</span><span class="o">(</span><span class="n">patchDocument</span><span class="o">,</span> <span class="n">contact</span><span class="o">,</span> <span class="nc">Contact</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="c1">// Persist the changes</span>
    <span class="n">contactService</span><span class="o">.</span><span class="na">updateContact</span><span class="o">(</span><span class="n">contactPatched</span><span class="o">);</span>

    <span class="c1">// Return 204 to indicate the request has succeeded</span>
    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">noContent</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>And the implementation is quite similar for JSON Merge Patch, except for the media type and for the types handled by the method:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PatchMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span> <span class="n">consumes</span> <span class="o">=</span> <span class="s">"application/merge-patch+json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">updateContact</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
                                          <span class="nd">@RequestBody</span> <span class="nc">JsonMergePatch</span> <span class="n">mergePatchDocument</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// Find the model that will be patched</span>
    <span class="nc">Contact</span> <span class="n">contact</span> <span class="o">=</span> <span class="n">contactService</span><span class="o">.</span><span class="na">findContact</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElseThrow</span><span class="o">(</span><span class="nl">ResourceNotFoundException:</span><span class="o">:</span><span class="k">new</span><span class="o">);</span>
    
    <span class="c1">// Apply the patch</span>
    <span class="nc">Contact</span> <span class="n">contactPatched</span> <span class="o">=</span> <span class="n">mergePatch</span><span class="o">(</span><span class="n">mergePatchDocument</span><span class="o">,</span> <span class="n">contact</span><span class="o">,</span> <span class="nc">Contact</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="c1">// Persist the changes</span>
    <span class="n">contactService</span><span class="o">.</span><span class="na">updateContact</span><span class="o">(</span><span class="n">contactPatched</span><span class="o">);</span>

    <span class="c1">// Return 204 to indicate the request has succeeded</span>
    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">noContent</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="validating-the-patch">Validating the patch</h2>

<p>Once the patch has been applied and before persisting the changes, we must ensure that the patch didn’t lead the resource to an <em>invalid</em> state. We could use <a href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/package-summary.html">Bean Validation annotations</a> to define constraints and then ensure that the state of the model is valid.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Contact</span> <span class="o">{</span>

    <span class="nd">@NotBlank</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>To perform the validation, we could inject <a href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/Validator.html"><code class="language-plaintext highlighter-rouge">Validator</code></a> in our class and invoke the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/Validator.html#validate-T-java.lang.Class...-"><code class="language-plaintext highlighter-rouge">validate()</code></a> method. If any constraint has been violated, it will return a set of <a href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/ConstraintViolation.html"><code class="language-plaintext highlighter-rouge">ConstraintViolation&lt;T&gt;</code></a> and then we can throw a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/ConstraintViolationException.html"><code class="language-plaintext highlighter-rouge">ConstraintViolationException</code></a>. So the method to apply the patch could be updated to handle the validation, as shown below:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">patch</span><span class="o">(</span><span class="nc">JsonPatch</span> <span class="n">patch</span><span class="o">,</span> <span class="no">T</span> <span class="n">targetBean</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">beanClass</span><span class="o">)</span> <span class="o">{</span>
    
    <span class="c1">// Convert the Java bean to a JSON document</span>
    <span class="nc">JsonStructure</span> <span class="n">target</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">targetBean</span><span class="o">,</span> <span class="nc">JsonStructure</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="c1">// Apply the JSON Patch to the JSON document</span>
    <span class="nc">JsonValue</span> <span class="n">patched</span> <span class="o">=</span> <span class="n">applyPatch</span><span class="o">(</span><span class="n">patch</span><span class="o">,</span> <span class="n">target</span><span class="o">);</span>

    <span class="c1">// Convert the JSON document to a Java bean</span>
    <span class="no">T</span> <span class="n">beanPatched</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">patched</span><span class="o">,</span> <span class="n">beanClass</span><span class="o">);</span>

    <span class="c1">// Validate the Java bean and throw an excetion if any constraint has been violated</span>
    <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">ConstraintViolation</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">violations</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">beanPatched</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">violations</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ConstraintViolationException</span><span class="o">(</span><span class="n">violations</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Return the bean that has been patched</span>
    <span class="k">return</span> <span class="n">beanPatched</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Alternatively, we could simply annotate the method with <a href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/Valid.html"><code class="language-plaintext highlighter-rouge">@Valid</code></a> and Bean Validation will take care of performing the the validation on the returned value (the Spring bean may need to be annotated with <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/annotation/Validated.html"><code class="language-plaintext highlighter-rouge">@Validated</code></a> to trigger the validation):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">patch</span><span class="o">(</span><span class="nc">JsonPatch</span> <span class="n">patch</span><span class="o">,</span> <span class="no">T</span> <span class="n">targetBean</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">beanClass</span><span class="o">)</span> <span class="o">{</span>
    
    <span class="c1">// Convert the Java bean to a JSON document</span>
    <span class="nc">JsonStructure</span> <span class="n">target</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">targetBean</span><span class="o">,</span> <span class="nc">JsonStructure</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="c1">// Apply the JSON Patch to the JSON document</span>
    <span class="nc">JsonValue</span> <span class="n">patched</span> <span class="o">=</span> <span class="n">applyPatch</span><span class="o">(</span><span class="n">patch</span><span class="o">,</span> <span class="n">target</span><span class="o">);</span>

    <span class="c1">// Convert the JSON document to a Java bean and return it</span>
    <span class="k">return</span> <span class="n">mapper</span><span class="o">.</span><span class="na">convertValue</span><span class="o">(</span><span class="n">patched</span><span class="o">,</span> <span class="n">beanClass</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="bonus-decoupling-the-domain-model-from-the-api-model">Bonus: Decoupling the domain model from the API model</h2>

<p>The models that represent the <em>domain</em> of our application and the models that represent the <em>data handled by our API</em> are (or at least should be) <em>different concerns</em> and should be <em>decoupled</em> from each other. We don’t want to break our API clients when we add, remove or rename a field from the application domain model. <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup></p>

<p>While our service layer operates over the domain/persistence models, our API controllers should operate over a different set of models. As our domain/persistence models evolve to support new business requirements, for example, we may want to create new versions of the API models to support these changes. We also may want to deprecate the old versions of our API as new versions are released. And it’s perfectly possible to achieve when the things are <em>decoupled</em>.</p>

<p>To minimize the boilerplate code of converting the domain model to the API model (and vice versa), we could rely on frameworks such as <a href="http://mapstruct.org/">MapStruct</a>. And we also could consider using <a href="https://projectlombok.org/">Lombok</a> to generate getters, setters, <code class="language-plaintext highlighter-rouge">equals()</code>, <code class="language-plaintext highlighter-rouge">hashcode()</code> and <code class="language-plaintext highlighter-rouge">toString()</code> methods for us.</p>

<p>By decoupling the API model from domain model, we also can ensure that we expose only the fields that can be modified. For example, we don’t want to allow the client to modify the <code class="language-plaintext highlighter-rouge">id</code> field of our domain model. So our API model shouldn’t contain the <code class="language-plaintext highlighter-rouge">id</code> field (and any attempt to modify it may cause an error or may be ignored).</p>

<p>In this example, the domain model class is called <code class="language-plaintext highlighter-rouge">Contact</code> and the model class that represents a resource is called <code class="language-plaintext highlighter-rouge">ContactResourceInput</code>. To convert between these two models with MapStruct, we could define a mapper interface and MapStruct will generate an implementation for it:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Mapper</span><span class="o">(</span><span class="n">componentModel</span> <span class="o">=</span> <span class="s">"spring"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ContactMapper</span> <span class="o">{</span>

    <span class="nc">ContactResourceInput</span> <span class="nf">asContactResourceInput</span><span class="o">(</span><span class="nc">Contact</span> <span class="n">contact</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">ContactResourceInput</span> <span class="n">contactResource</span><span class="o">,</span> <span class="nd">@MappingTarget</span> <span class="nc">Contact</span> <span class="n">contact</span><span class="o">);</span>
    
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">ContactMapper</code> implementation will be exposed as a Spring <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/stereotype/Component.html"><code class="language-plaintext highlighter-rouge">@Component</code></a>, so it can be injected in other Spring beans. Let me highlight that <em>MapStruct doesn’t use reflections</em>. Instead, it creates an actual implementation for the mapper interface and we can even check the code if we want to.</p>

<p>Once the <code class="language-plaintext highlighter-rouge">ContactMapper</code> is injected in our controller, we can use it to handle the model conversion. Here’s what the controller method for handling <code class="language-plaintext highlighter-rouge">PATCH</code> requests with JSON Patch could be like:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PatchMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span> <span class="n">consumes</span> <span class="o">=</span> <span class="s">"application/json-patch+json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">updateContact</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
                                          <span class="nd">@RequestBody</span> <span class="nc">JsonPatch</span> <span class="n">patchDocument</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// Find the domain model that will be patched</span>
    <span class="nc">Contact</span> <span class="n">contact</span> <span class="o">=</span> <span class="n">contactService</span><span class="o">.</span><span class="na">findContact</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElseThrow</span><span class="o">(</span><span class="nl">ResourceNotFoundException:</span><span class="o">:</span><span class="k">new</span><span class="o">);</span>
    
    <span class="c1">// Map the domain model to an API resource model</span>
    <span class="nc">ContactResourceInput</span> <span class="n">contactResource</span> <span class="o">=</span> <span class="n">contactMapper</span><span class="o">.</span><span class="na">asContactResourceInput</span><span class="o">(</span><span class="n">contact</span><span class="o">);</span>
    
    <span class="c1">// Apply the patch to the API resource model</span>
    <span class="nc">ContactResourceInput</span> <span class="n">contactResourcePatched</span> <span class="o">=</span> <span class="n">patch</span><span class="o">(</span><span class="n">patchDocument</span><span class="o">,</span> <span class="n">contactResource</span><span class="o">,</span> <span class="nc">ContactResourceInput</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

     <span class="c1">// Update the domain model with the details from the API resource model</span>
    <span class="n">contactMapper</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">contactResourcePatched</span><span class="o">,</span> <span class="n">contact</span><span class="o">);</span>
    
    <span class="c1">// Persist the changes</span>
    <span class="n">contactService</span><span class="o">.</span><span class="na">updateContact</span><span class="o">(</span><span class="n">contact</span><span class="o">);</span>

    <span class="c1">// Return 204 to indicate the request has succeeded</span>
    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">noContent</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>And, for comparision purposes, here’s a controller method for handling <code class="language-plaintext highlighter-rouge">PUT</code> requests:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PutMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/{id}"</span><span class="o">,</span> <span class="n">consumes</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">updateContact</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span>
                                          <span class="nd">@RequestBody</span> <span class="nd">@Valid</span> <span class="nc">ContactResourceInput</span> <span class="n">contactResource</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// Find the domain model that will be updated</span>
    <span class="nc">Contact</span> <span class="n">contact</span> <span class="o">=</span> <span class="n">contactService</span><span class="o">.</span><span class="na">findContact</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElseThrow</span><span class="o">(</span><span class="nl">ResourceNotFoundException:</span><span class="o">:</span><span class="k">new</span><span class="o">);</span>
    
    <span class="c1">// Update the domain model with the details from the API resource model</span>
    <span class="n">contactMapper</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">contactResource</span><span class="o">,</span> <span class="n">contact</span><span class="o">);</span>
    
    <span class="c1">// Persist the changes</span>
    <span class="n">contactService</span><span class="o">.</span><span class="na">updateContact</span><span class="o">(</span><span class="n">contact</span><span class="o">);</span>

    <span class="c1">// Return 204 to indicate the request has succeeded</span>
    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">noContent</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://tools.ietf.org/html/rfc7231">RFC 7231</a>: Semantics and content for the HTTP/1.1 protocol</li>
  <li><a href="https://tools.ietf.org/html/rfc5789">RFC 5789</a>: HTTP <code class="language-plaintext highlighter-rouge">PATCH</code> method</li>
  <li><a href="https://tools.ietf.org/html/rfc6902">RFC 6902</a>: JSON Patch</li>
  <li><a href="https://tools.ietf.org/html/rfc7396">RFC 7396</a>: JSON Merge Patch</li>
  <li><a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/package-summary.html"><code class="language-plaintext highlighter-rouge">javax.json</code></a>: Java API for JSON processing</li>
</ul>

<hr />

<h5 class="no_toc" id="footnotes">Footnotes</h5>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>You may not want to support <code class="language-plaintext highlighter-rouge">PUT</code> for creating resources if you rely on the server to generate identifiers for your resources. See my <a href="https://stackoverflow.com/a/56241060/1426227">answer</a> on Stack Overflow for details on this. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>I also have described the benefits of this approach in this <a href="https://stackoverflow.com/a/36175349/1426227">answer</a> on Stack Overflow. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

    </div>

    <div class="post__navigation">
      
      <a class="prev" href="/2018/07/23/comparing-json-documents-in-java/">
        <img class="post__nav-image lazy" data-src="/assets/images/posts/2018-07-23-comparing-json-documents-in-java/cover.jpg" alt="Comparing JSON documents in Java">
        <div class="post__nav-box">
          <div class="post__nav post__nav__prev"><i class="lni lni-chevron-left"></i> Previous Post</div>
          <h4 class="post__nav__title">Comparing JSON documents in Java</h4>
        </div>
      </a>
      
      
      <a class="next" href="/2019/06/23/asserting-exceptions-in-junit/">
        <img class="post__nav-image lazy" data-src="/assets/images/posts/2019-06-23-asserting-exceptions-in-junit/cover.jpg" alt="Asserting exceptions in JUnit">
        <div class="post__nav-box">
          <div class="post__nav post__nav__next">Next Post <i class="lni lni-chevron-right"></i></div>
          <h4 class="post__nav__title">Asserting exceptions in JUnit</h4>
        </div>
      </a>
      
    </div>

  </article>
</div>
<!-- end post -->







<div class="container">
  <div class="related-posts is-related">
    <div class="row">
      <div class="col col-12">
        <div class="container__inner">
          <h3 class="related-title">You may also like</h3>
          <div class="row grid">

          
            
            

            

            

            <div class="article col col-4 col-d-6 col-t-12 grid__post">
              <div class="article__inner">

                
                <a class="article__image" href="/2022/07/15/java-functional-interfaces-reference/">
                  <img class="lazy" data-src="/assets/images/posts/2022-07-15-java-functional-interfaces-reference/cover.jpg" alt="Java functional interfaces reference">
                </a>
                

                <div class="article__content">

                  <div class="article__meta">
                    <span class="article__minutes">
                      
                      
                        8 min read •
                      
                      <time class="article__date" datetime="2022-07-15T17:00:00+00:00">15 Jul 2022</time>
                    </span>
                  </div>

                  <h2 class="article__title">Java functional interfaces reference</h2>

                  <p class="article__excerpt"></p>

                  <div class="article__bottom">

                    
                    <div class="article__author">
                      <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
                    </div>
                    

                    <div class="article__bottom-meta">
                      
                        <a href="/about/" class="article__author-link">cassiomolin</a>
                      
                      
                      <span>in</span>
                      <span class="article-tags">
                        
                          <a href="/tag/java" class="article__tag">java</a>
                        
                      </span>
                      
                    </div>
                  </div>

                </div>

              </div>
            </div>

            
                
              
            
            
            

            

            

            <div class="article col col-4 col-d-6 col-t-12 grid__post">
              <div class="article__inner">

                
                <a class="article__image" href="/2021/07/29/should-http-put-create-a-resource-if-it-does-not-exist/">
                  <img class="lazy" data-src="/assets/images/posts/2021-07-29-should-http-put-create-a-resource-if-it-does-not-exist/cover.jpg" alt="Should HTTP PUT create a resource if it does not exist?">
                </a>
                

                <div class="article__content">

                  <div class="article__meta">
                    <span class="article__minutes">
                      
                      
                        3 min read •
                      
                      <time class="article__date" datetime="2021-07-29T17:00:00+00:00">29 Jul 2021</time>
                    </span>
                  </div>

                  <h2 class="article__title">Should HTTP PUT create a resource if it does not exist?</h2>

                  <p class="article__excerpt"></p>

                  <div class="article__bottom">

                    
                    <div class="article__author">
                      <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
                    </div>
                    

                    <div class="article__bottom-meta">
                      
                        <a href="/about/" class="article__author-link">cassiomolin</a>
                      
                      
                      <span>in</span>
                      <span class="article-tags">
                        
                          <a href="/tag/http" class="article__tag">http</a>
                        
                      </span>
                      
                    </div>
                  </div>

                </div>

              </div>
            </div>

            
                
              
            
            
            

            

            
            
            
            

            

            

            <div class="article col col-4 col-d-6 col-t-12 grid__post">
              <div class="article__inner">

                
                <a class="article__image" href="/2019/08/19/combining-jackson-streaming-api-with-objectmapper-for-parsing-json/">
                  <img class="lazy" data-src="/assets/images/posts/2019-08-19-combining-jackson-streaming-api-with-objectmapper-for-parsing-json/cover.jpg" alt="Combining the Jackson Streaming API with ObjectMapper for parsing JSON">
                </a>
                

                <div class="article__content">

                  <div class="article__meta">
                    <span class="article__minutes">
                      
                      
                        7 min read •
                      
                      <time class="article__date" datetime="2019-08-19T17:00:00+00:00">19 Aug 2019</time>
                    </span>
                  </div>

                  <h2 class="article__title">Combining the Jackson Streaming API with ObjectMapper for parsing JSON</h2>

                  <p class="article__excerpt"></p>

                  <div class="article__bottom">

                    
                    <div class="article__author">
                      <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
                    </div>
                    

                    <div class="article__bottom-meta">
                      
                        <a href="/about/" class="article__author-link">cassiomolin</a>
                      
                      
                      <span>in</span>
                      <span class="article-tags">
                        
                          <a href="/tag/java" class="article__tag">java</a>
                        
                          <a href="/tag/jackson" class="article__tag">jackson</a>
                        
                          <a href="/tag/json" class="article__tag">json</a>
                        
                      </span>
                      
                    </div>
                  </div>

                </div>

              </div>
            </div>

            
                
                  
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

 <!-- begin comments -->
<div class="container">
  <div class="row">
    <div class="col col-12">
      <div class="disqus-inner">
        <div id="disqus_thread" class="post-comments">
          <div id="disqus_empty"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function load_disqus() {
    var disqus_shortname = 'cassiomolin',
      is_disqus_empty = document.getElementById('disqus_empty'),
      disqus_target = document.getElementById('disqus_thread'),
      disqus_embed = document.createElement('script'),
      disqus_hook = (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]);

    if (disqus_target && is_disqus_empty) {
      disqus_embed.type = 'text/javascript';
      disqus_embed.async = true;
      disqus_embed.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      disqus_hook.appendChild(disqus_embed);
      is_disqus_empty.remove();
    }
  }

  window.addEventListener('scroll', function (e) {
    var currentScroll = document.scrollingElement.scrollTop;
    var disqus_target = document.getElementById('disqus_thread');

    if (disqus_target && (currentScroll > disqus_target.getBoundingClientRect().top - 150)) {
      load_disqus('disqus_shortname');
    }
  }, false);

</script>
<noscript>Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- end comments --> 
  </main> 
  <!-- end content -->
  
  <div class="top" title="Top"><i class="lni lni-chevron-up"></i></div>
  <!-- begin footer-widgets -->
<section class="footer-widgets">
  <div class="container">
    <div class="row">
      <div class="col col-6 col-d-6 col-t-12">
  <div class="widget widget-recent">

    <div class="widget__head">
      <h3 class="widget__title">Latest Posts</h3>
    </div>

    
    <div class="recent-posts">
      
      <a class="recent-posts__image" href="/2022/07/15/java-functional-interfaces-reference/"><img class="lazy" data-src="/assets/images/posts/2022-07-15-java-functional-interfaces-reference/cover.jpg" alt="Java functional interfaces reference"></a>
      
      <div class="recent-posts__content">
        <div class="article__meta">
          <span class="article__minutes">
            
            
              8 min read •
            
          </span>
          <time class="article__date"
            datetime="2022-07-15T17:00:00+00:00">15 Jul 2022</time>
        </div>
        <h4 class="recent-posts__title"><a href="/2022/07/15/java-functional-interfaces-reference/">Java functional interfaces reference</a></h4>
        <div class="article__bottom">
          <div class="article__author">
            <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
          </div>
          <div class="article__bottom-meta">
            <a href="/about/" class="article__author-link">cassiomolin</a>
          </div>
        </div>
      </div>
    </div>
    
    <div class="recent-posts">
      
      <a class="recent-posts__image" href="/2021/07/29/should-http-put-create-a-resource-if-it-does-not-exist/"><img class="lazy" data-src="/assets/images/posts/2021-07-29-should-http-put-create-a-resource-if-it-does-not-exist/cover.jpg" alt="Should HTTP PUT create a resource if it does not exist?"></a>
      
      <div class="recent-posts__content">
        <div class="article__meta">
          <span class="article__minutes">
            
            
              3 min read •
            
          </span>
          <time class="article__date"
            datetime="2021-07-29T17:00:00+00:00">29 Jul 2021</time>
        </div>
        <h4 class="recent-posts__title"><a href="/2021/07/29/should-http-put-create-a-resource-if-it-does-not-exist/">Should HTTP PUT create a resource if it does not exist?</a></h4>
        <div class="article__bottom">
          <div class="article__author">
            <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
          </div>
          <div class="article__bottom-meta">
            <a href="/about/" class="article__author-link">cassiomolin</a>
          </div>
        </div>
      </div>
    </div>
    

  </div>
</div>
      
<div class="col col-6 col-d-6 col-t-12">
  <div class="widget widget-tag-cloud">
    <div class="widget__head">
      <h3 class="widget__title">Explore Tags</h3>
    </div>
    <div class="tag__cloud">
      <a href="/tag/arquillian/" class="set-1">arquillian</a> <a href="/tag/authentication/" class="set-1">authentication</a> <a href="/tag/bean-validation/" class="set-1">bean-validation</a> <a href="/tag/beats/" class="set-1">beats</a> <a href="/tag/cdi/" class="set-1">cdi</a> <a href="/tag/docker/" class="set-1">docker</a> <a href="/tag/dto/" class="set-1">dto</a> <a href="/tag/ejb/" class="set-1">ejb</a> <a href="/tag/elastic-stack/" class="set-1">elastic-stack</a> <a href="/tag/elasticsearch/" class="set-1">elasticsearch</a> <a href="/tag/gson/" class="set-1">gson</a> <a href="/tag/guava/" class="set-1">guava</a> <a href="/tag/http/" class="set-1">http</a> <a href="/tag/jackson/" class="set-2">jackson</a> <a href="/tag/java/" class="set-5">java</a> <a href="/tag/javax-json/" class="set-1">javax-json</a> <a href="/tag/jax-rs/" class="set-1">jax-rs</a> <a href="/tag/jersey/" class="set-1">jersey</a> <a href="/tag/json/" class="set-3">json</a> <a href="/tag/junit/" class="set-1">junit</a> <a href="/tag/kibana/" class="set-1">kibana</a> <a href="/tag/log/" class="set-1">log</a> <a href="/tag/logback/" class="set-1">logback</a> <a href="/tag/logstash/" class="set-1">logstash</a> <a href="/tag/maven/" class="set-1">maven</a> <a href="/tag/patch/" class="set-1">patch</a> <a href="/tag/personal/" class="set-1">personal</a> <a href="/tag/rest/" class="set-1">rest</a> <a href="/tag/servlet/" class="set-1">servlet</a> <a href="/tag/slf4j/" class="set-1">slf4j</a> <a href="/tag/spring-boot/" class="set-1">spring-boot</a> <a href="/tag/test/" class="set-1">test</a>
    </div>
  </div>
</div>

    </div>
  </div>
</section>
<!-- end footer-widgets -->

<!-- begin footer -->
<footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col col-12">
      <div class="footer__inner">
        <div class="copyright">
          2023 &copy; <a href="/">cassiomolin</a>. Written with <i class="lni lni-heart-filled"></i> in Ireland.<br/>
          Powered by <a target="_blank" href="https://jekyllrb.com">Jekyll</a> and hosted on <a target="_blank" href="https://pages.github.com">GitHub Pages</a>.
        </div>
        
<div class="social">
  <ul class="social__list list-reset">
    
    <li class="social__item">
      <a class="social__link" href="https://www.linkedin.com/in/cassiomolin" aria-label="social icon"><i class="lni lni-linkedin-original"></i></a>
    </li>
    
    <li class="social__item">
      <a class="social__link" href="https://www.stackoverflow.com/u/1426227" aria-label="social icon"><i class="lni lni-stackoverflow"></i></a>
    </li>
    
    <li class="social__item">
      <a class="social__link" href="https://github.com/cassiomolin" aria-label="social icon"><i class="lni lni-github-original"></i></a>
    </li>
    
  </ul>
</div>

        </div>
      </div>
    </div>
  </div>
</footer>
<!-- end footer -->
  <script src="/assets/js/vendors/jquery-3.5.1.min.js"></script>
<script src="/assets/js/vendors/simple-jekyll-search.min.js"></script>
<script src="/assets/js/vendors/jquery.fitvids.js"></script>
<script src="/assets/js/vendors/lazyload.min.js"></script>
<script src="/assets/js/vendors/transition.js"></script>
<script src="/assets/js/vendors/zoom.min.js"></script>
<script src="/assets/js/vendors/prism.js"></script>
<script src="/assets/js/vendors/mermaid.min.js"></script>
<script src="/assets/js/common.js"></script>
<script>
  var base_url = "",
    pagination_next_url = base_url + '/page2',
    pagination_next_page_number = '',
    pagination_available_pages_number = '';
</script>
</body>

</html>