<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Token-based authentication with JAX-RS 2.0 | cassiomolin</title>
  <meta name='description' content='I am a software engineer living and working in Ireland. And this is my not-so-frequently-updated coding blog.'>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Token-based authentication with JAX-RS 2.0 | cassiomolin</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Token-based authentication with JAX-RS 2.0" />
<meta name="author" content="Cassio Mazzochi Molin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to perform authentication with tokens in JAX-RS applications." />
<meta property="og:description" content="How to perform authentication with tokens in JAX-RS applications." />
<link rel="canonical" href="https://cassiomolin.com/2014/11/06/token-based-authentication-with-jaxrs-20/" />
<meta property="og:url" content="https://cassiomolin.com/2014/11/06/token-based-authentication-with-jaxrs-20/" />
<meta property="og:site_name" content="cassiomolin" />
<meta property="og:image" content="https://cassiomolin.com/assets/images/posts/2014-11-06-token-based-authentication-with-jaxrs-20/cover.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-11-06T11:17:03+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://cassiomolin.com/assets/images/posts/2014-11-06-token-based-authentication-with-jaxrs-20/cover.jpg" />
<meta property="twitter:title" content="Token-based authentication with JAX-RS 2.0" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Cassio Mazzochi Molin"},"dateModified":"2014-11-06T11:17:03+00:00","datePublished":"2014-11-06T11:17:03+00:00","description":"How to perform authentication with tokens in JAX-RS applications.","headline":"Token-based authentication with JAX-RS 2.0","image":"https://cassiomolin.com/assets/images/posts/2014-11-06-token-based-authentication-with-jaxrs-20/cover.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://cassiomolin.com/2014/11/06/token-based-authentication-with-jaxrs-20/"},"url":"https://cassiomolin.com/2014/11/06/token-based-authentication-with-jaxrs-20/"}</script>
<!-- End Jekyll SEO tag -->


  <link rel="canonical" href="https://cassiomolin.com/2014/11/06/token-based-authentication-with-jaxrs-20/">
  <link rel="alternate" type="application/rss+xml" title="cassiomolin" href="/feed.xml">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com"> 
  <link href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i&display=swap" rel="stylesheet">

  <!-- LineIcons -->
  <link href="https://cdn.lineicons.com/2.0/LineIcons.css" rel="stylesheet">

  <!-- Favicon and other icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icon//favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icon//favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69796629-3', 'auto');
  ga('send', 'pageview');
</script>
  

  <style>
  
  /*!------------------------------------------------------------------
[MAIN STYLESHEET]
-------------------------------------------------------------------*/.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.show{display:block}.hide{display:none}.invisible{visibility:hidden}.list-reset{list-style-type:none;margin:0;padding:0}.clearfix::after,.clearfix ::before{content:"";display:table;clear:both}.screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}/*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:30px}ul,ol,dd{margin-left:20px}.highlight{border-radius:4px;color:#fff;background:#17151E;font-size:14px;border-radius:16px}.highlight code[class*="language-"],.highlight pre[class*="language-"]{color:#ccc;background:none;font-family:Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}.highlight pre[class*="language-"]{padding:1em;overflow:auto}.highlight :not(pre)>code[class*="language-"],.highlight pre[class*="language-"]{background:#17151E}.highlight :not(pre)>code[class*="language-"]{padding:.1em;border-radius:.3em;white-space:normal}.highlight .token.comment,.highlight .token.block-comment,.highlight .token.prolog,.highlight .token.doctype,.highlight .token.cdata{color:#999}.highlight .token.punctuation{color:#ccc}.highlight .token.tag,.highlight .token.attr-name,.highlight .token.namespace,.highlight .token.deleted{color:#e2777a}.highlight .token.function-name{color:#6196cc}.highlight .token.boolean,.highlight .token.number,.highlight .token.function{color:#f08d49}.highlight .token.property,.highlight .token.class-name,.highlight .token.constant,.highlight .token.symbol{color:#f8c555}.highlight .token.selector,.highlight .token.important,.highlight .token.atrule,.highlight .token.keyword,.highlight .token.builtin{color:#cc99cd}.highlight .token.string,.highlight .token.char,.highlight .token.attr-value,.highlight .token.regex,.highlight .token.variable{color:#7ec699}.highlight .token.operator,.highlight .token.entity,.highlight .token.url{color:#67cdcc}.highlight .token.important,.highlight .token.bold{font-weight:bold}.highlight .token.italic{font-style:italic}.highlight .token.entity{cursor:help}.highlight .token.inserted{color:green}.container{max-width:1340px;padding-left:20px;padding-right:20px;margin:0 auto}.container-big{max-width:1600px;padding-left:20px;padding-right:20px;margin:0 auto}.row{display:flex;flex-wrap:wrap;flex:0 1 auto;flex-direction:row;box-sizing:border-box;margin-left:-16px;margin-right:-16px}.col{padding-left:16px;padding-right:16px}[class^="col-"]{flex:auto}.col-0{width:0%}.col-1{width:8.3333333333%}.col-2{width:16.6666666667%}.col-3{width:25%}.col-4{width:33.3333333333%}.col-5{width:41.6666666667%}.col-6{width:50%}.col-7{width:58.3333333333%}.col-8{width:66.6666666667%}.col-9{width:75%}.col-10{width:83.3333333333%}.col-11{width:91.6666666667%}.col-12{width:100%}.push-0{margin-left:0%}.push-1{margin-left:8.3333333333%}.push-2{margin-left:16.6666666667%}.push-3{margin-left:25%}.push-4{margin-left:33.3333333333%}.push-5{margin-left:41.6666666667%}.push-6{margin-left:50%}.push-7{margin-left:58.3333333333%}.push-8{margin-left:66.6666666667%}.push-9{margin-left:75%}.push-10{margin-left:83.3333333333%}.push-11{margin-left:91.6666666667%}.push-12{margin-left:100%}.pull-0{margin-right:0%}.pull-1{margin-right:8.3333333333%}.pull-2{margin-right:16.6666666667%}.pull-3{margin-right:25%}.pull-4{margin-right:33.3333333333%}.pull-5{margin-right:41.6666666667%}.pull-6{margin-right:50%}.pull-7{margin-right:58.3333333333%}.pull-8{margin-right:66.6666666667%}.pull-9{margin-right:75%}.pull-10{margin-right:83.3333333333%}.pull-11{margin-right:91.6666666667%}.pull-12{margin-right:100%}@media (max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media (max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}@media (max-width: 992px){.col-d-0{width:0%}.col-d-1{width:8.3333333333%}.col-d-2{width:16.6666666667%}.col-d-3{width:25%}.col-d-4{width:33.3333333333%}.col-d-5{width:41.6666666667%}.col-d-6{width:50%}.col-d-7{width:58.3333333333%}.col-d-8{width:66.6666666667%}.col-d-9{width:75%}.col-d-10{width:83.3333333333%}.col-d-11{width:91.6666666667%}.col-d-12{width:100%}.push-d-0{margin-left:0%}.push-d-1{margin-left:8.3333333333%}.push-d-2{margin-left:16.6666666667%}.push-d-3{margin-left:25%}.push-d-4{margin-left:33.3333333333%}.push-d-5{margin-left:41.6666666667%}.push-d-6{margin-left:50%}.push-d-7{margin-left:58.3333333333%}.push-d-8{margin-left:66.6666666667%}.push-d-9{margin-left:75%}.push-d-10{margin-left:83.3333333333%}.push-d-11{margin-left:91.6666666667%}.push-d-12{margin-left:100%}.pull-d-0{margin-right:0%}.pull-d-1{margin-right:8.3333333333%}.pull-d-2{margin-right:16.6666666667%}.pull-d-3{margin-right:25%}.pull-d-4{margin-right:33.3333333333%}.pull-d-5{margin-right:41.6666666667%}.pull-d-6{margin-right:50%}.pull-d-7{margin-right:58.3333333333%}.pull-d-8{margin-right:66.6666666667%}.pull-d-9{margin-right:75%}.pull-d-10{margin-right:83.3333333333%}.pull-d-11{margin-right:91.6666666667%}.pull-d-12{margin-right:100%}}@media (max-width: 768px){.col-t-0{width:0%}.col-t-1{width:8.3333333333%}.col-t-2{width:16.6666666667%}.col-t-3{width:25%}.col-t-4{width:33.3333333333%}.col-t-5{width:41.6666666667%}.col-t-6{width:50%}.col-t-7{width:58.3333333333%}.col-t-8{width:66.6666666667%}.col-t-9{width:75%}.col-t-10{width:83.3333333333%}.col-t-11{width:91.6666666667%}.col-t-12{width:100%}.push-t-0{margin-left:0%}.push-t-1{margin-left:8.3333333333%}.push-t-2{margin-left:16.6666666667%}.push-t-3{margin-left:25%}.push-t-4{margin-left:33.3333333333%}.push-t-5{margin-left:41.6666666667%}.push-t-6{margin-left:50%}.push-t-7{margin-left:58.3333333333%}.push-t-8{margin-left:66.6666666667%}.push-t-9{margin-left:75%}.push-t-10{margin-left:83.3333333333%}.push-t-11{margin-left:91.6666666667%}.push-t-12{margin-left:100%}.pull-t-0{margin-right:0%}.pull-t-1{margin-right:8.3333333333%}.pull-t-2{margin-right:16.6666666667%}.pull-t-3{margin-right:25%}.pull-t-4{margin-right:33.3333333333%}.pull-t-5{margin-right:41.6666666667%}.pull-t-6{margin-right:50%}.pull-t-7{margin-right:58.3333333333%}.pull-t-8{margin-right:66.6666666667%}.pull-t-9{margin-right:75%}.pull-t-10{margin-right:83.3333333333%}.pull-t-11{margin-right:91.6666666667%}.pull-t-12{margin-right:100%}}@media (max-width: 576px){.col-m-0{width:0%}.col-m-1{width:8.3333333333%}.col-m-2{width:16.6666666667%}.col-m-3{width:25%}.col-m-4{width:33.3333333333%}.col-m-5{width:41.6666666667%}.col-m-6{width:50%}.col-m-7{width:58.3333333333%}.col-m-8{width:66.6666666667%}.col-m-9{width:75%}.col-m-10{width:83.3333333333%}.col-m-11{width:91.6666666667%}.col-m-12{width:100%}.push-m-0{margin-left:0%}.push-m-1{margin-left:8.3333333333%}.push-m-2{margin-left:16.6666666667%}.push-m-3{margin-left:25%}.push-m-4{margin-left:33.3333333333%}.push-m-5{margin-left:41.6666666667%}.push-m-6{margin-left:50%}.push-m-7{margin-left:58.3333333333%}.push-m-8{margin-left:66.6666666667%}.push-m-9{margin-left:75%}.push-m-10{margin-left:83.3333333333%}.push-m-11{margin-left:91.6666666667%}.push-m-12{margin-left:100%}.pull-m-0{margin-right:0%}.pull-m-1{margin-right:8.3333333333%}.pull-m-2{margin-right:16.6666666667%}.pull-m-3{margin-right:25%}.pull-m-4{margin-right:33.3333333333%}.pull-m-5{margin-right:41.6666666667%}.pull-m-6{margin-right:50%}.pull-m-7{margin-right:58.3333333333%}.pull-m-8{margin-right:66.6666666667%}.pull-m-9{margin-right:75%}.pull-m-10{margin-right:83.3333333333%}.pull-m-11{margin-right:91.6666666667%}.pull-m-12{margin-right:100%}}img[data-action="zoom"]{cursor:pointer;cursor:-webkit-zoom-in;cursor:-moz-zoom-in}.zoom-img,.zoom-img-wrap{position:relative;z-index:999;-webkit-transition:all 300ms;-o-transition:all 300ms;transition:all 300ms}img.zoom-img{cursor:pointer;cursor:-webkit-zoom-out;cursor:-moz-zoom-out}.zoom-overlay{z-index:420;background:#0f0e15;position:fixed;top:0;left:0;right:0;bottom:0;pointer-events:none;opacity:0;-webkit-transition:opacity 300ms;-o-transition:opacity 300ms;transition:opacity 300ms}@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none){.zoom-overlay{-webkit-backdrop-filter:saturate(180%) blur(24px);backdrop-filter:saturate(180%) blur(24px);background:rgba(15,14,21,0.8)}}.zoom-overlay-open .zoom-overlay{opacity:1}.zoom-overlay-open,.zoom-overlay-transitioning{cursor:default}.animate{animation:animateElement cubic-bezier(0.3, 0.45, 0.45, 0.95) 0.75s;animation-duration:0.75s;animation-iteration-count:1}@keyframes animateElement{0%{opacity:0}100%{opacity:1}}*,*::after,*::before{box-sizing:border-box}@media only print{*,*::after,*::before{color:#000 !important}}body{font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:18px;line-height:1.7;color:#eee;background-color:#0f0e15;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-x:hidden}body.is-in::after{visibility:hidden;opacity:0;pointer-events:none}body::after{content:"";position:fixed;left:0;top:0;width:100%;height:100%;background-color:#09080f;z-index:999;transition:1s}body input,body textarea{border:1px solid #eee;outline:none}body.overlay-active{overflow:hidden}@media only screen and (max-width: 576px){body{font-size:16px;line-height:29px}}::placeholder{color:#aaa}*::selection{color:#fff;background-color:rgba(255,123,123,0.7)}h1,h2,h3,h4,h5,h6{font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-weight:700;line-height:1.4em;letter-spacing:-1px;color:#eee}h1{font-size:36px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}blockquote{position:relative;padding:50px 0px 30px 70px;margin-bottom:0;color:#fff}blockquote:before{content:'\201C';position:absolute;left:0;font-size:8em;line-height:0;color:#ff7b7b}blockquote p{margin-bottom:20px}blockquote cite{font-size:16px;font-style:normal;font-weight:700;color:#eee}blockquote cite:before{content:'\2014' '\00a0'}@media only screen and (max-width: 576px){blockquote{padding:50px 0px 30px 60px}}pre{overflow:auto;padding:20px;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}img,.zoom-img-wrap{max-width:100%;height:auto;vertical-align:middle}img+em,.zoom-img-wrap+em{display:inline-block;width:100%;padding:20px 0 0;font-size:12px;font-style:normal;line-height:1;text-align:center;color:#eee}a{text-decoration:none;color:#eee;transition:all 0.2s}a:hover{color:#ff7b7b}hr{display:block;width:100%;margin:40px 0 80px 0;border:0;text-align:center}hr:after{content:"* * *";font-size:2em}.table-container{display:block;max-width:100%;overflow-x:auto}table{font-size:12px;color:rgba(238,238,238,0.7);width:100%;border-width:1px;border-color:#09080f;border-collapse:collapse}table th{padding:12px;font-size:16px;text-align:left;border:1px solid #09080f;color:#fff;background-color:#17151E}table tr{background-color:#09080f;transition:all .3s ease}table tr:nth-child(even){background-color:transparent}table tr:hover{color:#fff}table td{padding:12px;font-size:14px;border:1px solid #09080f}.gallery-box{margin-bottom:30px}.gallery-box em{display:inline-block;width:100%;padding:20px 0 0;font-size:12px;font-style:normal;line-height:1;text-align:center;color:#eee}.gallery-box em a{border-bottom:2px solid rgba(238,238,238,0.1)}.gallery-box em a:hover{border-color:#ff7b7b;color:#eee;text-decoration:none}.gallery{display:grid;grid-template-columns:repeat(3, auto);justify-content:center;align-content:center;grid-gap:10px}.gallery img{width:100%;height:auto}.lazy{opacity:0;transition:0.4s ease}.lazy.loaded{opacity:1}.hero{position:relative;margin-bottom:32px;overflow:hidden;background-color:#09080f}@media only screen and (max-width: 576px){.hero{box-shadow:none}}.hero__inner::before{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;background:linear-gradient(180deg, rgba(15,14,21,0.6) 0%, #0f0e15 100%)}.hero__image{min-height:664px;user-select:none;background-color:#09080f}.hero__image img{position:absolute;top:0px;width:100%;height:100%;object-fit:cover}@media only screen and (max-width: 992px){.hero__image{min-height:620px}}@media only screen and (max-width: 768px){.hero__image{min-height:500px}}@media only screen and (max-width: 576px){.hero__image{min-height:400px}}.hero__content{position:absolute;top:55%;left:50%;transform:translate(-50%, -50%);z-index:1;width:100%;max-width:650px;padding:0 20px;text-align:center}.hero__content .social{margin-top:30px}.home .hero__content{top:calc(55% + 30px)}.hero__title{font-size:58px;margin:0 0 10px;line-height:1;color:#fff}@media only screen and (max-width: 576px){.hero__title{font-size:32px;margin:0 0 10px}}.hero__desc{font-size:20px;color:#aaa;margin:0}@media only screen and (max-width: 576px){.hero__desc{font-size:16px;line-height:21px}}.hero-without-image{margin:192px 0 96px}.hero-without-image .hero-inner{display:flex;align-items:center;justify-content:center}.hero-without-image .hero-content{width:100%;max-width:650px;padding:0 20px;text-align:center}@media only screen and (max-width: 576px){.hero-without-image{margin:144px 0 48px}}.top{position:fixed;bottom:25px;right:-100px;z-index:5;width:40px;height:40px;line-height:40px;text-align:center;border-radius:8px;background-color:#09080f;color:#fff;cursor:pointer;transition:all .25s ease}.top:hover{color:#09080f;background:#ff7b7b}.top.is-active{right:30px}@media only screen and (max-width: 768px){.top{bottom:15px}.top.is-active{right:25px}}.header{width:100%;margin:60px 0 120px;transition:all 0.2s;color:#fff}.header.header--top{position:absolute;top:0;z-index:100}@media only screen and (max-width: 992px){.header{margin:30px 0 60px}}.header__inner{position:relative;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}.logo__link{font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:28px;line-height:1;font-weight:900;vertical-align:middle;color:#eee;text-decoration:none;letter-spacing:-1px}.logo__link:hover{color:#ff7b7b}.logo__image{max-height:40px}.main-nav{width:100%;max-width:1300px;margin:0 auto}.main-nav__box{display:flex;align-items:center;width:80%;padding-top:200px;margin:0 auto}.main-nav__box .nav__icon-close{position:absolute;top:32px;right:20px;z-index:5;display:flex;align-items:center;justify-content:center;font-size:30px;text-align:center;line-height:40px;color:rgba(255,255,255,0.5);transition:all .25s ease;cursor:pointer}.main-nav__box .nav__icon-close:hover{color:#fff}@media only screen and (max-width: 768px){.main-nav__box{padding-top:100px}.main-nav__box .nav__icon-close{top:32px;right:20px}}@media only screen and (max-width: 576px){.main-nav__box{width:90%}}.navigation{display:flex;align-items:center}.top-nav .nav__list .nav__item{display:inline-block;margin-right:40px}.top-nav .nav__list .nav__item:last-child{margin-right:0}.top-nav .nav__list .nav__item .nav__link{position:relative;font-size:14px;font-weight:700;letter-spacing:1px;text-transform:uppercase;text-decoration:none;color:#eee}.top-nav .nav__list .nav__item .nav__link:hover{color:#ff7b7b}@media only screen and (max-width: 992px){.top-nav{display:none}}.mobile-nav .nav__list .nav__item{display:block;margin-bottom:36px;text-align:center}.mobile-nav .nav__list .nav__item:last-child{margin-bottom:0}.mobile-nav .nav__list .nav__item .nav__link{position:relative;font-size:18px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:#eee}.mobile-nav .nav__list .nav__item .nav__link:hover{color:#ff7b7b}@media only screen and (max-width: 576px){.mobile-nav .nav__list .nav__item{margin-bottom:28px}}.nav-buttons{display:flex;align-items:center;font-size:24px;color:#eee}.nav-buttons .search-button{display:flex;align-items:center;cursor:pointer;transition:all 0.2s}.nav-buttons .search-button span{transition:all 0.2s}.nav-buttons .search-button:hover span{color:#ff7b7b}.nav-buttons .search-button span{display:block;margin-left:8px;font-size:14px;font-weight:700;letter-spacing:1px;text-transform:uppercase}@media only screen and (max-width: 992px){.nav-buttons .search-button span{display:none}}.nav-buttons .nav__icon-menu{display:none;margin-left:20px}@media only screen and (max-width: 992px){.nav-buttons .nav__icon-menu{display:block}}.nav-buttons .nav__icon{cursor:pointer}.menu-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:100;opacity:0;visibility:hidden;background-color:#09080f;transition:all 0.5s ease-in-out}.menu-overlay.is-open{opacity:1;visibility:visible}@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none){.menu-overlay{-webkit-backdrop-filter:saturate(180%) blur(24px);backdrop-filter:saturate(180%) blur(24px);background-color:rgba(9,8,15,0.9)}}@media only screen and (min-width: 992px){.menu-overlay{display:none}}.nav-grid{width:100%;height:75vh;overflow-y:auto}.nav-grid__item{margin-bottom:30px}@media only screen and (max-width: 768px){.nav-grid__item{height:auto}}.nav-grid__title{position:relative;margin-bottom:48px;padding-bottom:15px;font-size:40px;text-align:center;color:#eee}.nav-grid__title::after{content:"";position:absolute;left:50%;bottom:0;transform:translate(-50%, -50%);display:block;width:25px;height:2px;background-color:#fff}@media only screen and (max-width: 768px){.nav-grid__title{margin-bottom:30px}}.search{position:fixed;top:0;left:0;right:0;bottom:0;z-index:100;overflow:auto;opacity:0;visibility:hidden;background-color:#09080f;transition:all 0.5s ease-in-out}.search.is-visible{opacity:1;visibility:visible}@supports (-webkit-backdrop-filter: none) or (backdrop-filter: none){.search{-webkit-backdrop-filter:saturate(180%) blur(24px);backdrop-filter:saturate(180%) blur(24px);background-color:rgba(9,8,15,0.9)}}.search__box{position:relative;max-width:540px;width:100%;margin:0 auto;padding-top:140px}.search__box .search__close{position:absolute;top:50%;right:24px;transform:translateY(-50%);font-size:30px;line-height:1;color:rgba(238,238,238,0.5);transition:all .25s;cursor:pointer}.search__box .search__close:hover{color:#eee}@media only screen and (max-width: 768px){.search__box{width:80%;padding-top:100px}}@media only screen and (max-width: 576px){.search__box{width:90%}}.search__group{position:relative;margin-bottom:64px}.search__group .search__text{width:100%;height:auto;padding:16px 24px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:24px;font-weight:900;line-height:42px;border-radius:8px;border:4px solid rgba(238,238,238,0.1);transition:all .3s;color:#fff;background-color:transparent}.search__group .search__text::-webkit-input-placeholder{font-weight:900;color:rgba(238,238,238,0.8)}.search__group .search__text::placeholder{font-weight:900;color:rgba(238,238,238,0.8)}.search__group .search__text::-ms-clear{display:none}.search__group .search__text:focus{color:#eee;background:#09080f}@media only screen and (max-width: 576px){.search__group .search__text{font-size:26px}}.search-results-list .no-results{width:100%;list-style:none}.search-results-list .no-results h3{font-size:28px;text-align:center}.load-more{margin:0 auto}.load-more-section{margin:30px auto;text-align:center}@media only screen and (max-width: 576px){.load-more-section{margin:20px auto}}.footer-widgets{padding:64px 0 32px}.footer-widgets .row .col{flex-grow:1}@media only screen and (max-width: 768px){.footer-widgets{padding:48px 0 0}}.widget{margin-bottom:40px}@media only screen and (max-width: 768px){.widget{margin-bottom:64px}}.widget__title{position:relative;padding-left:8px;margin-bottom:36px;font-size:24px;line-height:1;color:#fff}.widget__title::after{content:"";position:absolute;left:0;top:50%;z-index:-1;transform:translateY(-50%);display:block;width:106px;height:38px;border-radius:4px 0px 0px 4px;background:linear-gradient(90deg, #ff7b7b -5.19%, rgba(15,14,21,0) 100%)}@media only screen and (max-width: 992px){.widget__title{font-size:24px}}.recent-posts{display:flex;align-items:center;margin-bottom:20px}.recent-posts:last-child{margin-bottom:0}@media only screen and (max-width: 360px){.recent-posts{flex-wrap:wrap;margin-bottom:32px}}.recent-posts__image{position:relative;display:block;width:100%;max-width:135px;height:144px;margin-right:20px;border-radius:16px;overflow:hidden;background:#09080f}.recent-posts__image img{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:16px;object-fit:cover}@media only screen and (max-width: 360px){.recent-posts__image{height:auto;max-width:100%;padding-top:56.6%;margin:0 0 20px}}.recent-posts__content .recent-posts__title{font-size:18px;margin:8px 0}.recent-posts__content .article__author-image{width:28px;height:28px}.tag__cloud{display:flex;flex-wrap:wrap}.tag__cloud a{display:inline-block;padding:6px 9px;margin:0 5px 5px 0;font-size:14px;line-height:14px;font-weight:500;text-transform:lowercase;border:2px solid rgba(255,255,255,0.4);border-radius:24px;color:#aaa;word-break:keep-all}.tag__cloud a:hover{border-color:#ff7b7b;color:#fff}.subscribe-subtitle{width:100%;margin-bottom:24px;font-size:16px;line-height:24px;color:#aaa}.subscribe-group-top{display:flex;align-items:center}.subscribe-group-top .subscribe-email{position:relative;width:100%;height:56px;padding:20px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:14px;line-height:20px;font-weight:700;border-radius:8px;color:#fff;background-color:#17151E;border:2px solid transparent;outline:0;-webkit-appearance:none;box-sizing:border-box;transition:border-color .2s ease-in-out;cursor:text}.subscribe-group-top .subscribe-email::placeholder{color:#eee}.subscribe-group-top .subscribe-email:focus{color:#fff;border-color:#ff7b7b}.subscribe-group-top .subscribe-button{margin-left:10px}.footer{position:relative;padding:64px 0;border-top:2px solid #09080f}.footer .footer__inner{display:flex;justify-content:space-between;align-items:center}@media only screen and (max-width: 992px){.footer .footer__inner{flex-direction:column}.footer .footer__inner .copyright{order:1}}@media only screen and (max-width: 768px){.footer .footer__inner{align-items:flex-start}}.copyright{font-size:15px;color:#aaa}.copyright a{font-weight:500;color:#fff}.copyright a:hover{color:#ff7b7b}.social{text-align:center}.social .social__list{display:flex;flex-wrap:wrap;justify-content:center;align-items:center}.social .social__item{display:inline-block;margin-left:8px}.social .social__item:first-child{margin-left:0}.social .social__link{display:flex;justify-content:center;align-items:center;width:40px;height:40px;font-size:20px;line-height:40px;border-radius:8px;color:#fff}.social .social__link:hover{color:#ff7b7b}@media only screen and (max-width: 992px){.social{margin-bottom:5px}.social .social__item{margin-bottom:10px}}.button{display:inline-block;white-space:nowrap;vertical-align:middle;font:inherit;border:none;border-radius:8px;outline:none;-webkit-appearance:none;text-align:center;text-decoration:none;color:#fff;transition:all 0.2s ease;cursor:pointer}.button:hover{color:#fff}.button--primary{padding:20px 40px;font-size:16px;font-weight:700;line-height:1;background-color:#17151E}.button--primary:hover{color:#09080f;background-color:#ff6262}.button--middle{position:relative;padding:24px 48px;width:100%;max-width:412px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:12px;font-weight:700;letter-spacing:1px;text-transform:uppercase;transition:all .2s ease;background-color:#09080f}.button--middle:hover{background-color:#17151E}.button--big{display:block;width:100%}.article{align-items:stretch;flex-grow:1;min-height:340px;margin-bottom:32px;transition:transform .2s ease}.article::after{content:"";display:table;padding-top:25%}.article--big::after{padding-top:35%}@media only screen and (max-width: 992px){.article--big::after{padding-top:25%}}@media only screen and (max-width: 576px){.article{min-height:280px}}.article__inner{position:relative;display:flex;width:100%;height:100%;border-radius:16px;overflow:hidden;box-shadow:0 5px 10px 0 rgba(0,0,0,0.5);background-color:#09080f}.article__inner .featured-post{position:absolute;top:20px;right:20px;z-index:10;padding:4px 6px;font-size:20px;border-radius:4px;color:#aaa;background:rgba(255,255,255,0.08);pointer-events:none}@media only screen and (max-width: 576px){.article__inner .featured-post{right:20px}}.article__title{margin:12px 0 12px;font-size:28px;line-height:1}.article__title a{color:#eee}@media only screen and (max-width: 576px){.article__title{font-size:24px}}.article__excerpt{margin-bottom:12px;font-size:14px;line-height:17px;color:#aaa}@media only screen and (max-width: 576px){.article__excerpt{font-size:13px}}.article__image{position:absolute;display:block;width:100%;height:100%;overflow:hidden;user-select:none;background-color:#09080f}.article__image::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(0deg, rgba(0,0,0,0.98) 0%, rgba(0,0,0,0.02) 100%, rgba(255,255,255,0.725928) 100%);pointer-events:none}.article__image a,.article__image img{position:absolute;top:0;width:100%;height:100%;object-fit:cover;border-radius:16px;pointer-events:none}.article__content{z-index:1;width:100%;margin-top:auto;padding:0 32px 32px;pointer-events:none}@media only screen and (max-width: 576px){.article__content{padding:20px}}.article__meta{line-height:14px}.article__meta .article__date,.article__meta .article__minutes{font-size:14px;line-height:1;font-weight:500}.article__bottom{display:flex;font-size:14px;font-weight:500;color:#fff}.article__bottom a{pointer-events:all}.article__bottom-meta{padding-top:2px}.article-tags .article__tag{display:inline-block;padding:6px 9px;margin:2px 0;font-size:14px;line-height:12px;font-weight:500;text-transform:lowercase;letter-spacing:-0.5px;border:2px solid #fff;border-radius:24px;color:#fff;word-break:keep-all}.article-tags .article__tag:hover{color:#fff;border-color:#ff7b7b}.article__author{float:left;flex-shrink:0}.article__author-image{position:relative;display:inline-block;width:36px;height:36px;padding:3px;margin-right:8px;border:2px solid #ff7b7b;border-radius:50%;overflow:hidden}.article__author-image img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.article__author-link{font-size:14px;color:#fff}.article__author-link:hover{color:#fff}.article__author span{color:rgba(255,255,255,0.8)}.post,.page{position:relative;max-width:760px;margin:0 auto}.post-head{margin-bottom:64px}.post-head .row{align-items:center}.post-head .post-head__box{margin-left:32px}.post-head .no-image.row{display:block}.post-head .no-image .post-head__box{position:relative;max-width:760px;margin:0 auto}@media only screen and (max-width: 992px){.post-head .post-head__box{margin-left:16px}}@media only screen and (max-width: 768px){.post-head{margin-bottom:40px}.post-head .post-head__box{margin-left:0}.post-head .row{flex-direction:column}}.post-image{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:16px;object-fit:cover}.image-box{position:relative;padding-top:90%;min-height:280px;border-radius:16px;overflow:hidden;box-shadow:0 5px 10px 0px rgba(0,0,0,0.15);background-color:#09080f}@media only screen and (max-width: 768px){.image-box{padding-top:65%;margin-bottom:40px}}.post__meta{line-height:13px}.post__meta .post__date,.post__meta .post__minutes{line-height:1;font-weight:500}.post__title{margin:20px 0 20px;font-size:56px;line-height:1}@media only screen and (max-width: 1200px){.post__title{font-size:40px}}@media only screen and (max-width: 576px){.post__title{font-size:32px}}.post__bottom{display:flex;font-size:14px;line-height:40px;font-weight:500;color:#fff}.post-tags .post__tag{padding:6px 9px;margin:2px 0;font-size:14px;line-height:14px;font-weight:500;border:2px solid #eee;border-radius:24px;color:#eee;word-break:keep-all}.post-tags .post__tag:hover{color:#fff;border-color:#ff7b7b}.post__author{float:left;flex-shrink:0}.post__author-image{position:relative;display:inline-block;width:36px;height:36px;padding:3px;margin-right:8px;border:2px solid #ff7b7b;border-radius:50%;overflow:hidden}.post__author-image img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.post__author-link{font-size:14px;color:#fff}.post__author-link:hover{color:#fff}.post__author span{color:rgba(255,255,255,0.8)}.post__content,.page__content{color:#eee;word-wrap:break-word;margin-bottom:80px}.post__content a,.page__content a{border-bottom:1px solid rgba(238,238,238,0.3);color:#fff}.post__content a:hover,.page__content a:hover{color:#ff7b7b;border-color:#ff7b7b;text-decoration:none}.post__content p code,.post__content p kbd,.post__content p samp,.post__content li code,.post__content li kbd,.post__content li samp,.page__content p code,.page__content p kbd,.page__content p samp,.page__content li code,.page__content li kbd,.page__content li samp{font-size:14px;font-family:Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace}.post__content table td code,.post__content table td kbd,.post__content table td samp,.page__content table td code,.page__content table td kbd,.page__content table td samp{font-size:12px}.post__content pre,.page__content pre{background-color:#17151E}.post__content h1 code,.post__content h2 code,.post__content h3 code,.post__content h4 code,.post__content h5 code,.post__content h6 code,.page__content h1 code,.page__content h2 code,.page__content h3 code,.page__content h4 code,.page__content h5 code,.page__content h6 code{font-size:85%}.post__content img,.page__content img{background-color:#fff;margin:0 auto;display:block}.post__content>ul,.page__content>ul{margin-left:40px}.post__content div.mermaid,.page__content div.mermaid{text-align:center;border-radius:16px;background-color:#17151E;padding:16px}.post__share{display:flex;justify-content:center;margin:64px 0}.post__share .share__list{display:inline-flex;justify-content:center;align-items:center;border-radius:16px;background:#17151E}.post__share .share__list .share__link{position:relative;display:flex;justify-content:center;align-items:center;padding:28px 24px;font-size:20px;color:#eee;transition:all .2s}.post__share .share__list .share__link:first-child{padding-left:48px}.post__share .share__list .share__link:first-child::after{content:none}.post__share .share__list .share__link:last-child{padding-right:48px}.post__share .share__list .share__link::after{content:"";position:absolute;left:0;display:block;width:1px;height:12px;background:rgba(238,238,238,0.08)}.post__share .share__list .share__link:hover{color:#ff7b7b}@media only screen and (max-width: 576px){.post__share{margin:48px 0}.post__share .share__list .share__link{padding:24px 20px}.post__share .share__list .share__link:first-child{padding-left:40px}.post__share .share__list .share__link:last-child{padding-right:40px}}.post__navigation{display:flex;justify-content:space-between;margin-bottom:64px;box-shadow:0 5px 10px 0 rgba(0,0,0,0.5);border-radius:16px}.post__navigation .prev,.post__navigation .prev img{border-radius:16px 0 0 16px}.post__navigation .next,.post__navigation .next img{border-radius:0 16px 16px 0}.post__navigation .prev,.post__navigation .next{position:relative;display:flex;align-items:flex-end;width:100%;min-height:240px;padding:0 32px 32px;overflow:hidden;background-size:cover;background-position:center;background-repeat:no-repeat;user-select:none}.post__navigation .prev::after,.post__navigation .next::after{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(0deg, rgba(0,0,0,0.98) 0%, rgba(0,0,0,0.02) 100%, rgba(255,255,255,0.725928) 100%);pointer-events:none;transition:.25s}.post__navigation .prev .post__nav,.post__navigation .next .post__nav{display:inline-block;margin-bottom:8px;font-size:12px;font-weight:500;text-transform:uppercase;color:#eee}.post__navigation .prev .post__nav-image,.post__navigation .next .post__nav-image{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.post__navigation .prev .post__nav-box,.post__navigation .next .post__nav-box{position:relative;z-index:1;width:100%}.post__navigation .prev .post__nav__prev i,.post__navigation .next .post__nav__prev i{margin-right:4px}.post__navigation .prev .post__nav__next i,.post__navigation .next .post__nav__next i{margin-left:4px}.post__navigation .prev .post__nav__title,.post__navigation .next .post__nav__title{margin-bottom:0;font-size:24px;line-height:1}.post__navigation .prev .post__nav__title a,.post__navigation .next .post__nav__title a{color:#eee}.post__navigation .next{text-align:right;margin-left:auto}@media only screen and (max-width: 768px){.post__navigation{flex-wrap:wrap;box-shadow:none}.post__navigation .prev,.post__navigation .next{width:100%;border-radius:16px;box-shadow:0 5px 10px 0 rgba(0,0,0,0.5)}.post__navigation .prev img,.post__navigation .next img{border-radius:16px}.post__navigation .prev{margin-bottom:20px}}@media only screen and (max-width: 576px){.post__navigation{margin-bottom:48px}}.related-posts{display:none}.related-posts.is-related{display:block}.related-posts .related-title{position:relative;padding-left:8px;margin-bottom:36px;font-size:24px;line-height:1;color:#fff}.related-posts .related-title::after{content:"";position:absolute;left:0;top:50%;z-index:-1;transform:translateY(-50%);display:block;width:106px;height:38px;border-radius:4px 0px 0px 4px;background:linear-gradient(90deg, #ff7b7b -5.19%, rgba(15,14,21,0) 100%)}@media only screen and (max-width: 992px){.related-posts .related-title{font-size:24px}}.disqus-inner{border-radius:16px;background:#17151E}.post-comments{max-width:824px;padding:64px 32px;margin:0 auto}@media only screen and (max-width: 576px){.post-comments{padding:48px 32px}}.archive-box{position:relative;margin:50px 0 80px;text-align:center}@media only screen and (max-width: 576px){.archive-box{margin:20px 0 50px}}.archive-meta{font-size:16px;color:rgba(238,238,238,0.6)}.archive-title{position:relative;margin:0;font-size:47px;line-height:57px;text-transform:lowercase}@media only screen and (max-width: 576px){.archive-title{font-size:40px;line-height:52px}}.archive-description{max-width:600px;margin:10px auto 0;font-size:16px;line-height:32px}@media only screen and (max-width: 576px){.archive-description{margin:5px auto 0;line-height:28px}}.contact-form .form__group{margin-bottom:20px}.contact-form .form__input{width:100%;padding:20px;font-family:"Karla",-apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",sans-serif;font-size:16px;font-weight:700;border:2px solid transparent;border-radius:8px;color:#eee;background:#17151E;transition:border-color .2s ease-in-out}.contact-form .form__input::placeholder{color:#fff}.contact-form .form__input:focus{border-color:#ff7b7b}.contact-form textarea{resize:vertical}.contact-form button[type="submit"]{border-radius:10px;will-change:transform;transition:all .1s ease;cursor:pointer;color:#fff;outline:none;text-align:center}.contact-form button.submitting[type="submit"]{cursor:wait;font-size:0;padding:0;width:50px;height:50px;border-radius:25px;background:transparent;border:2px solid #ff7b7b;border-right:2px solid #fff;animation:loader .4s linear infinite}@keyframes loader{0%{transform:rotateZ(0)}100%{transform:rotateZ(360deg)}}.contact-form .message-sent{text-align:center;display:none}.cv .timeline{position:relative;margin:3em 0}.cv .timeline:before{content:'';position:absolute;top:8px;left:50%;margin-left:2px;width:2px;height:100%;background:#aaa;z-index:1;left:8px;width:2px}.cv .timeline:after{content:'';border-bottom:2px solid #aaa;width:22px;display:block;top:9px;position:relative}.cv .timeline-block{display:block;margin-bottom:2.5em;padding-left:2.5em}.cv .marker{width:25px;height:25px;border-radius:100%;border:2px solid #ff7b7b;background:#ff7b7b;z-index:99;display:block;position:absolute;left:-1px;margin-top:6px}.cv .timeline-content h3{margin-bottom:0px;font-size:1.4em;font-weight:500}.cv .timeline-content span{font-size:1em;display:block}.cv .timeline-content span.contractor{display:inline;color:#fff;font-size:10px;margin-left:.3em;position:relative;top:-4px}.cv .timeline-content span.contractor:before{content:'contract';border:1px solid #fff;background-color:#09080f;border-radius:1em;padding:2px 7px;vertical-align:middle;letter-spacing:0.5px;text-transform:uppercase}.cv .timeline-content p{margin-bottom:0px}.cv .timeline-content p.company-summary{margin-top:1em}.cv .timeline-content p.company-name,.cv .timeline-content p.date{color:#fff}.cv .timeline-content ul{padding:1em 0 0 1em}.cv .timeline-content ul li{margin-bottom:.4em}@media only screen and (max-width: 800px){.cv .marker{width:17px;height:17px;left:3px}.cv .timeline-block{padding-left:2em}.cv .timeline-content h3{font-size:1.3em}}@media only screen and (max-width: 600px){.cv .timeline-content h3{font-size:1.25em}}.page__content .about__author{text-align:center}.page__content .about__author-image{position:relative;display:inline-block;width:200px;height:200px;padding:3px;margin-bottom:30px;border:2px solid #ff7b7b;border-radius:50%;overflow:hidden;background-color:transparent}

  </style>
</head>

<body>

  

<!-- begin header -->
<header class="header ">
  <div class="container">
    <div class="row">
      <div class="header__inner col col-12">

      <div class="logo">
        <a class="logo__link" href="/">
        
          cassiomolin
        
        </a>
      </div>
        
      <div class="menu-overlay">
        <nav class="main-nav">
          <div class="main-nav__box">
            <div class="nav__icon-close">
              <i class="lni lni-close"></i>
            </div>
            <div class="nav-grid">
              <div class="nav-grid__item">
                <h2 class="nav-grid__title">Menu</h2>
                <div class="mobile-nav">
                  <ul class="nav__list list-reset">
  <li class="nav__item">
    <a href="/" class="nav__link">Home</a>
  </li>
  
    
  
    
      
      <li class="nav__item">
        <a href="/about/" class="nav__link">About</a>
      </li>
      
    
  
    
      
    
  
    
      
      <li class="nav__item">
        <a href="/contact/" class="nav__link">Contact Me</a>
      </li>
      
    
  
    
      
      <li class="nav__item">
        <a href="/cv/" class="nav__link">CV</a>
      </li>
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
</ul>
                </div>
              </div>
            </div>
          </div>
        </nav>
      </div>

      <div class="navigation">
        <div class="top-nav">
          <ul class="nav__list list-reset">
  <li class="nav__item">
    <a href="/" class="nav__link">Home</a>
  </li>
  
    
  
    
      
      <li class="nav__item">
        <a href="/about/" class="nav__link">About</a>
      </li>
      
    
  
    
      
    
  
    
      
      <li class="nav__item">
        <a href="/contact/" class="nav__link">Contact Me</a>
      </li>
      
    
  
    
      
      <li class="nav__item">
        <a href="/cv/" class="nav__link">CV</a>
      </li>
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
</ul>
        </div>
      </div>

      <div class="nav-buttons">
        <div class="search-button">
          <i class="nav__icon nav__icon-search lni lni-search-alt"></i>
          <span>Search</span>
        </div>
        <i class="nav__icon nav__icon-menu lni lni-menu"></i>
      </div>

      </div>
    </div>
  </div>
</header>
<!-- end header -->

<!-- begin search -->
<div class="search">
  <div class="container">
    <div class="row">
      <div class="col col-12">
        <div class="search__box">
          <div class="search__group">
            <div class="search__close">
              <i class="lni lni-close"></i>
            </div>
            <label for="js-search-input" class="screen-reader-text">Search for Blog</label>
            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="Type to search...">
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row search-results-list" id="js-results-container"></div>
  </div>

</div>
<!-- end search -->

  <!-- begin content -->
  <main class="content" aria-label="Content">
    <div class="post-head">
  <div class="container">
    <div class="row">
      
      <div class="col col-6 col-t-12">
        <div class="image-box">
          <img class="post-image lazy" data-src="/assets/images/posts/2014-11-06-token-based-authentication-with-jaxrs-20/cover.jpg" alt="Token-based authentication with JAX-RS 2.0">
        </div>
      </div>
      
  
      <div class="col col-6 col-t-12">
        <div class="post-head__box">
        
          <div class="post__meta">
            <span class="post__minutes">
              
              
                18 min read 
              
              <time class="post__date"
                datetime="2014-11-06T11:17:03+00:00">06 Nov 2014</time>
            </span>
          </div>
        
          <h2 class="post__title">Token-based authentication with JAX-RS 2.0</h2>
        
          <div class="post__bottom">
        
            <div class="post__author">
              <a href="/about/" aria-label="cassiomolin"><img class="post__author-image"
                  src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
            </div>
        
            <div class="post__bottom-meta">
              <a href="/about/" class="post__author-link">cassiomolin</a>
              
              <span>in</span>
              <span class="post-tags">
                
                <a href="/tag/authentication" class="post__tag">authentication</a>
                
                <a href="/tag/java" class="post__tag">java</a>
                
                <a href="/tag/jax-rs" class="post__tag">jax-rs</a>
                
              </span>
              
            </div>
          </div>
        
        </div>
      </div>
    </div>
  </div>
</div>

<!-- begin post -->
<div class="container">
  <article class="post animate">

    <div class="post__content">
      <p>In token-based authentication, the client exchanges <em>hard credentials</em> (such as username and password) for a piece of data called <em>token</em>. For each request, instead of sending the hard credentials, the client will send the token to the server to perform authentication and then authorization.</p>

<p>In a few words, an authentication scheme based on tokens follow these steps:</p>

<ol>
  <li>The client sends their credentials (username and password) to the server.</li>
  <li>The server authenticates the credentials and, if they are valid, generate a token for the user.</li>
  <li>The server stores the previously generated token in some storage along with the user identifier and an expiration date.</li>
  <li>The server sends the generated token to the client.</li>
  <li>The client sends the token to the server in each request.</li>
  <li>The server, in each request, extracts the token from the incoming request. With the token, the server looks up the user details to perform authentication.
    <ul>
      <li>If the token is valid, the server accepts the request.</li>
      <li>If the token is invalid, the server refuses the request.</li>
    </ul>
  </li>
  <li>Once the authentication has been performed, the server performs authorization.</li>
  <li>The server can provide an endpoint to refresh tokens.</li>
</ol>

<p><strong>Note:</strong> The step 3 may not be required if the server has issued a signed token (such as JWT, which allows you to perform <em>stateless</em> authentication).</p>

<h2 id="what-you-can-do-with-jax-rs-20-jersey-resteasy-and-apache-cxf">What you can do with JAX-RS 2.0 (Jersey, RESTEasy and Apache CXF)</h2>

<p>This solution uses only the JAX-RS 2.0 API, <em>avoiding any vendor specific solution</em>. So, it should work with JAX-RS 2.0 implementations, such as <a href="https://jersey.github.io/">Jersey</a>, <a href="http://resteasy.jboss.org/">RESTEasy</a> and <a href="https://cxf.apache.org/">Apache CXF</a>.</p>

<p>It is worthwhile to mention that if you are using token-based authentication, you are not relying on the standard Java EE web application security mechanisms offered by the servlet container and configurable via applications <code class="language-plaintext highlighter-rouge">web.xml</code> descriptor. Its a custom authentication.</p>

<h3 id="authenticating-a-user-with-their-username-and-password-and-issuing-a-token">Authenticating a user with their username and password and issuing a token</h3>

<p>Create a JAX-RS resource method which receives and validates the credentials (username and password) and issue a token for the user:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Path</span><span class="o">(</span><span class="s">"/authentication"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuthenticationEndpoint</span> <span class="o">{</span>

    <span class="nd">@POST</span>
    <span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_FORM_URLENCODED</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">authenticateUser</span><span class="o">(</span><span class="nd">@FormParam</span><span class="o">(</span><span class="s">"username"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">username</span><span class="o">,</span> 
                                     <span class="nd">@FormParam</span><span class="o">(</span><span class="s">"password"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>

        <span class="k">try</span> <span class="o">{</span>

            <span class="c1">// Authenticate the user using the credentials provided</span>
            <span class="n">authenticate</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>

            <span class="c1">// Issue a token for the user</span>
            <span class="nc">String</span> <span class="n">token</span> <span class="o">=</span> <span class="n">issueToken</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>

            <span class="c1">// Return the token on the response</span>
            <span class="k">return</span> <span class="nc">Response</span><span class="o">.</span><span class="na">ok</span><span class="o">(</span><span class="n">token</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">Response</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">FORBIDDEN</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
        <span class="o">}</span>      
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Authenticate against a database, LDAP, file or whatever</span>
        <span class="c1">// Throw an Exception if the credentials are invalid</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">issueToken</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Issue a token (can be a random String persisted to a database or a JWT token)</span>
        <span class="c1">// The issued token must be associated to a user</span>
        <span class="c1">// Return the issued token</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>If any exceptions are thrown when validating the credentials, a response with the status <code class="language-plaintext highlighter-rouge">403</code> (Forbidden) will be returned.</p>

<p>If the credentials are successfully validated, a response with the status <code class="language-plaintext highlighter-rouge">200</code> (OK) will be returned and the issued token will be sent to the client in the response payload. The client must send the token to the server in every request.</p>

<p>When consuming <code class="language-plaintext highlighter-rouge">application/x-www-form-urlencoded</code>, the client must to send the credentials in the following format in the request payload:</p>

<pre><code class="language-nocode">username=admin&amp;password=123456
</code></pre>

<p>Instead of form params, its possible to wrap the username and the password into a class:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Credentials</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    
    <span class="c1">// Getters and setters omitted</span>
<span class="o">}</span>
</code></pre></div></div>

<p>And then consume it as JSON:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@POST</span>
<span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
<span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Response</span> <span class="nf">authenticateUser</span><span class="o">(</span><span class="nc">Credentials</span> <span class="n">credentials</span><span class="o">)</span> <span class="o">{</span>

    <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="na">getUsername</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="na">getPassword</span><span class="o">();</span>
    
    <span class="c1">// Authenticate the user, issue a token and return a response</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Using this approach, the client must to send the credentials in the following format in the payload of the request:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="extracting-the-token-from-the-request-and-validating-it">Extracting the token from the request and validating it</h3>

<p>The client should send the token in the standard HTTP <code class="language-plaintext highlighter-rouge">Authorization</code> header of the request. For example:</p>

<pre><code class="language-nocode">Authorization: Bearer &lt;token-goes-here&gt;
</code></pre>

<p>The name of the standard HTTP header is unfortunate because it carries <em>authentication</em> information, not <em>authorization</em>. However, its the standard HTTP header for sending credentials to the server.</p>

<p>JAX-RS provides <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/NameBinding.html"><code class="language-plaintext highlighter-rouge">@NameBinding</code></a>, a meta-annotation used to create other annotations to bind filters and interceptors to resource classes and methods. Define a <code class="language-plaintext highlighter-rouge">@Secured</code> annotation as following:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@NameBinding</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="no">RUNTIME</span><span class="o">)</span>
<span class="nd">@Target</span><span class="o">({</span><span class="no">TYPE</span><span class="o">,</span> <span class="no">METHOD</span><span class="o">})</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Secured</span> <span class="o">{</span> <span class="o">}</span>
</code></pre></div></div>

<p>The above defined name-binding annotation will be used to decorate a filter class, which implements <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/container/ContainerRequestFilter.html"><code class="language-plaintext highlighter-rouge">ContainerRequestFilter</code></a>, allowing you to intercept the request before it be handled by a resource method. The <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/container/ContainerRequestContext.html"><code class="language-plaintext highlighter-rouge">ContainerRequestContext</code></a> can be used to access the HTTP request headers and then extract the token:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Secured</span>
<span class="nd">@Provider</span>
<span class="nd">@Priority</span><span class="o">(</span><span class="nc">Priorities</span><span class="o">.</span><span class="na">AUTHENTICATION</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuthenticationFilter</span> <span class="kd">implements</span> <span class="nc">ContainerRequestFilter</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">AUTHENTICATION_SCHEME</span> <span class="o">=</span> <span class="s">"Bearer"</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">filter</span><span class="o">(</span><span class="nc">ContainerRequestContext</span> <span class="n">requestContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>

        <span class="c1">// Get the Authorization header from the request</span>
        <span class="nc">String</span> <span class="n">authorizationHeader</span> <span class="o">=</span>
                <span class="n">requestContext</span><span class="o">.</span><span class="na">getHeaderString</span><span class="o">(</span><span class="nc">HttpHeaders</span><span class="o">.</span><span class="na">AUTHORIZATION</span><span class="o">);</span>

        <span class="c1">// Validate the Authorization header</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">isTokenBasedAuthentication</span><span class="o">(</span><span class="n">authorizationHeader</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">abortWithUnauthorized</span><span class="o">(</span><span class="n">requestContext</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// Extract the token from the Authorization header</span>
        <span class="nc">String</span> <span class="n">token</span> <span class="o">=</span> <span class="n">authorizationHeader</span>
                            <span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="no">AUTHENTICATION_SCHEME</span><span class="o">.</span><span class="na">length</span><span class="o">()).</span><span class="na">trim</span><span class="o">();</span>

        <span class="k">try</span> <span class="o">{</span>

            <span class="c1">// Validate the token</span>
            <span class="n">validateToken</span><span class="o">(</span><span class="n">token</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">abortWithUnauthorized</span><span class="o">(</span><span class="n">requestContext</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isTokenBasedAuthentication</span><span class="o">(</span><span class="nc">String</span> <span class="n">authorizationHeader</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// Check if the Authorization header is valid</span>
        <span class="c1">// It must not be null and must be prefixed with "Bearer" plus a whitespace</span>
        <span class="c1">// Authentication scheme comparison must be case-insensitive</span>
        <span class="k">return</span> <span class="n">authorizationHeader</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">authorizationHeader</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="no">AUTHENTICATION_SCHEME</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">abortWithUnauthorized</span><span class="o">(</span><span class="nc">ContainerRequestContext</span> <span class="n">requestContext</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// Abort the filter chain with a 401 status code</span>
        <span class="c1">// The "WWW-Authenticate" is sent along with the response</span>
        <span class="n">requestContext</span><span class="o">.</span><span class="na">abortWith</span><span class="o">(</span>
                <span class="nc">Response</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="nc">Response</span><span class="o">.</span><span class="na">Status</span><span class="o">.</span><span class="na">UNAUTHORIZED</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="nc">HttpHeaders</span><span class="o">.</span><span class="na">WWW_AUTHENTICATE</span><span class="o">,</span> <span class="no">AUTHENTICATION_SCHEME</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">build</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateToken</span><span class="o">(</span><span class="nc">String</span> <span class="n">token</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Check if it was issued by the server and if it's not expired</span>
        <span class="c1">// Throw an Exception if the token is invalid</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>If any problems happen during the token validation, a response with the status <code class="language-plaintext highlighter-rouge">401</code> (Unauthorized) will be returned. Otherwise the request will proceed to a resource method.</p>

<h3 id="securing-your-rest-endpoints">Securing your REST endpoints</h3>

<p>To bind the authentication filter to resource methods or resource classes, annotate them with the <code class="language-plaintext highlighter-rouge">@Secured</code> annotation created above. For the methods and/or classes that are annotated, the filter will be executed. It means that such endpoints will <em>only</em> be reached if the request is performed with a valid token.</p>

<p>If some methods or classes do not need authentication, simply do not annotate them:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Path</span><span class="o">(</span><span class="s">"/example"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleResource</span> <span class="o">{</span>

    <span class="nd">@GET</span>
    <span class="nd">@Path</span><span class="o">(</span><span class="s">"{id}"</span><span class="o">)</span>
    <span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">myUnsecuredMethod</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// This method is not annotated with @Secured</span>
        <span class="c1">// The authentication filter won't be executed before invoking this method</span>
        <span class="o">...</span>
    <span class="o">}</span>

    <span class="nd">@DELETE</span>
    <span class="nd">@Secured</span>
    <span class="nd">@Path</span><span class="o">(</span><span class="s">"{id}"</span><span class="o">)</span>
    <span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">mySecuredMethod</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// This method is annotated with @Secured</span>
        <span class="c1">// The authentication filter will be executed before invoking this method</span>
        <span class="c1">// The HTTP request must be performed with a valid token</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In the example shown above, the filter will be executed <em>only</em> for the <code class="language-plaintext highlighter-rouge">mySecuredMethod(Long)</code> method because its annotated with <code class="language-plaintext highlighter-rouge">@Secured</code>.</p>

<h2 id="identifying-the-current-user">Identifying the current user</h2>

<p>Its very likely that you will need to know the user who is performing the request agains your REST API. The following approaches can be used to achieve it:</p>

<h3 id="overriding-the-security-context-of-the-current-request">Overriding the security context of the current request</h3>

<p>Within your <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/container/ContainerRequestFilter.html#filter-javax.ws.rs.container.ContainerRequestContext-"><code class="language-plaintext highlighter-rouge">ContainerRequestFilter.filter(ContainerRequestContext)</code></a> method, a new <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/SecurityContext.html"><code class="language-plaintext highlighter-rouge">SecurityContext</code></a> instance can be set for the current request. Then override the <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/SecurityContext.html#getUserPrincipal--"><code class="language-plaintext highlighter-rouge">SecurityContext.getUserPrincipal()</code></a>, returning a <a href="http://docs.oracle.com/javase/7/docs/api/java/security/Principal.html"><code class="language-plaintext highlighter-rouge">Principal</code></a> instance:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">SecurityContext</span> <span class="n">currentSecurityContext</span> <span class="o">=</span> <span class="n">requestContext</span><span class="o">.</span><span class="na">getSecurityContext</span><span class="o">();</span>
<span class="n">requestContext</span><span class="o">.</span><span class="na">setSecurityContext</span><span class="o">(</span><span class="k">new</span> <span class="nc">SecurityContext</span><span class="o">()</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Principal</span> <span class="nf">getUserPrincipal</span><span class="o">()</span> <span class="o">{</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">Principal</span><span class="o">()</span> <span class="o">{</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">username</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isUserInRole</span><span class="o">(</span><span class="nc">String</span> <span class="n">role</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isSecure</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">currentSecurityContext</span><span class="o">.</span><span class="na">isSecure</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getAuthenticationScheme</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Bearer"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre></div></div>

<p>Use the token to look up the user identifier (username), which will be the <a href="http://docs.oracle.com/javase/7/docs/api/java/security/Principal.html"><code class="language-plaintext highlighter-rouge">Principal</code></a>s name.</p>

<p>Inject the <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/SecurityContext.html"><code class="language-plaintext highlighter-rouge">SecurityContext</code></a> in any JAX-RS resource class:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Context</span>
<span class="nc">SecurityContext</span> <span class="n">securityContext</span><span class="o">;</span>
</code></pre></div></div>

<p>The same can be done in a JAX-RS resource method:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GET</span>
<span class="nd">@Secured</span>
<span class="nd">@Path</span><span class="o">(</span><span class="s">"{id}"</span><span class="o">)</span>
<span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Response</span> <span class="nf">myMethod</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">,</span> 
                         <span class="nd">@Context</span> <span class="nc">SecurityContext</span> <span class="n">securityContext</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>And then get the <a href="http://docs.oracle.com/javase/7/docs/api/java/security/Principal.html"><code class="language-plaintext highlighter-rouge">Principal</code></a>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Principal</span> <span class="n">principal</span> <span class="o">=</span> <span class="n">securityContext</span><span class="o">.</span><span class="na">getUserPrincipal</span><span class="o">();</span>
<span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">principal</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="using-cdi-context-and-dependency-injection">Using CDI (Context and Dependency Injection)</h3>

<p>If, for some reason, you dont want to override the <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/SecurityContext.html"><code class="language-plaintext highlighter-rouge">SecurityContext</code></a>, you can use CDI (Context and Dependency Injection), which provides useful features such as events and producers.</p>

<p>Create a CDI qualifier:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Qualifier</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="no">RUNTIME</span><span class="o">)</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="no">METHOD</span><span class="o">,</span> <span class="no">FIELD</span><span class="o">,</span> <span class="no">PARAMETER</span> <span class="o">})</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">AuthenticatedUser</span> <span class="o">{</span> <span class="o">}</span>
</code></pre></div></div>

<p>In your <code class="language-plaintext highlighter-rouge">AuthenticationFilter</code> created above, inject an <a href="https://docs.oracle.com/javaee/7/api/javax/enterprise/event/Event.html"><code class="language-plaintext highlighter-rouge">Event</code></a> annotated with <code class="language-plaintext highlighter-rouge">@AuthenticatedUser</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Inject</span>
<span class="nd">@AuthenticatedUser</span>
<span class="nc">Event</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">userAuthenticatedEvent</span><span class="o">;</span>
</code></pre></div></div>

<p>If the authentication succeeds, fire the event passing the username as parameter (remember, the token is issued for a user and the token will be used to look up the user identifier):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">userAuthenticatedEvent</span><span class="o">.</span><span class="na">fire</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
</code></pre></div></div>

<p>Its very likely that theres a class that represents a user in your application. Lets call this class <code class="language-plaintext highlighter-rouge">User</code>.</p>

<p>Create a CDI bean to handle the authentication event, find a <code class="language-plaintext highlighter-rouge">User</code> instance with the correspondent username and assign it to the <code class="language-plaintext highlighter-rouge">authenticatedUser</code> producer field:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestScoped</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuthenticatedUserProducer</span> <span class="o">{</span>

    <span class="nd">@Produces</span>
    <span class="nd">@RequestScoped</span>
    <span class="nd">@AuthenticatedUser</span>
    <span class="kd">private</span> <span class="nc">User</span> <span class="n">authenticatedUser</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleAuthenticationEvent</span><span class="o">(</span><span class="nd">@Observes</span> <span class="nd">@AuthenticatedUser</span> <span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">authenticatedUser</span> <span class="o">=</span> <span class="n">findUser</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">User</span> <span class="nf">findUser</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Hit the the database or a service to find a user by its username and return it</span>
        <span class="c1">// Return the User instance</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">authenticatedUser</code> field produces a <code class="language-plaintext highlighter-rouge">User</code> instance that can be injected into container managed beans, such as JAX-RS services, CDI beans, servlets and EJBs. Use the following piece of code to inject a <code class="language-plaintext highlighter-rouge">User</code> instance (in fact, its a CDI proxy):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Inject</span>
<span class="nd">@AuthenticatedUser</span>
<span class="nc">User</span> <span class="n">authenticatedUser</span><span class="o">;</span>
</code></pre></div></div>

<p>Note that the CDI <a href="http://docs.oracle.com/javaee/7/api/javax/enterprise/inject/Produces.html"><code class="language-plaintext highlighter-rouge">@Produces</code></a> annotation is <em>different</em> from the JAX-RS <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/Produces.html"><code class="language-plaintext highlighter-rouge">@Produces</code></a> annotation:</p>

<ul>
  <li>CDI: <a href="http://docs.oracle.com/javaee/7/api/javax/enterprise/inject/Produces.html"><code class="language-plaintext highlighter-rouge">javax.enterprise.inject.Produces</code></a></li>
  <li>JAX-RS: <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/Produces.html"><code class="language-plaintext highlighter-rouge">javax.ws.rs.Produces</code></a></li>
</ul>

<p>Be sure you use the CDI <a href="http://docs.oracle.com/javaee/7/api/javax/enterprise/inject/Produces.html"><code class="language-plaintext highlighter-rouge">@Produces</code></a> annotation in your <code class="language-plaintext highlighter-rouge">AuthenticatedUserProducer</code> bean.</p>

<p>The key here is the bean annotated with <a href="http://docs.oracle.com/javaee/7/api/javax/enterprise/context/RequestScoped.html"><code class="language-plaintext highlighter-rouge">@RequestScoped</code></a>, allowing you to share data between filters and your beans. If you dont want to use events, you can modify the filter to store the authenticated user in a request scoped bean and then read it from your JAX-RS resource classes.</p>

<p>Compared to the approach that overrides the <a href="http://docs.oracle.com/javaee/7/api/javax/ws/rs/core/SecurityContext.html"><code class="language-plaintext highlighter-rouge">SecurityContext</code></a>, the CDI approach allows you to get the authenticated user from beans other than JAX-RS resources and providers.</p>

<h2 id="issuing-tokens">Issuing tokens</h2>

<p>A token can be:</p>

<ul>
  <li><strong>Opaque:</strong> Reveals no details other than the value itself (like a random string)</li>
  <li><strong>Self-contained:</strong> Contains details about the token itself (like JWT).</li>
</ul>

<p>See details below:</p>

<h3 id="random-string-as-token">Random string as token</h3>

<p>A token can be issued by generating a random string and persisting it to a database along with the user identifier and an expiration date. A good example of how to generate a random string in Java can be seen <a href="https://stackoverflow.com/a/41156/1426227">here</a>. You also could use:</p>

<!-- language: lang-java -->
<p>Random random = new SecureRandom();
String token = new BigInteger(130, random).toString(32);</p>

<h3 id="jwt-json-web-token">JWT (JSON Web Token)</h3>

<p>JWT (JSON Web Token) is a standard method for representing claims securely between two parties and is defined by the <a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>.</p>

<p>Its a self-contained token and it enables you to store details in <em>claims</em>. These claims are stored in the token payload which is a JSON encoded as <a href="https://en.wikipedia.org/wiki/Base64">Base64</a>. Here are some claims registered in the <a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a> and what they mean (read the full RFC for further details):</p>

<ul>
  <li><a href="https://tools.ietf.org/html/rfc7519#section-4.1.1"><code class="language-plaintext highlighter-rouge">iss</code></a>: Principal that issued the token.</li>
  <li><a href="https://tools.ietf.org/html/rfc7519#section-4.1.2"><code class="language-plaintext highlighter-rouge">sub</code></a>: Principal that is the subject of the JWT.</li>
  <li><a href="https://tools.ietf.org/html/rfc7519#section-4.1.4"><code class="language-plaintext highlighter-rouge">exp</code></a>: Expiration date for the token.</li>
  <li><a href="https://tools.ietf.org/html/rfc7519#section-4.1.5"><code class="language-plaintext highlighter-rouge">nbf</code></a>: Time on which the token will start to be accepted for processing.</li>
  <li><a href="https://tools.ietf.org/html/rfc7519#section-4.1.6"><code class="language-plaintext highlighter-rouge">iat</code></a>: Time on which the token was issued.</li>
  <li><a href="https://tools.ietf.org/html/rfc7519#section-4.1.7"><code class="language-plaintext highlighter-rouge">jti</code></a>: Unique identifier for the token.</li>
</ul>

<p>Be aware that you must not store sensitive data, such as passwords, in the token.</p>

<p>The payload can be read by the client and the integrity of the token can be easily checked by verifying its signature on the server. The signature is what prevents the token from being tampered with.</p>

<p>You wont need to persist JWT tokens if you dont need to track them. Althought, by persisting the tokens, you will have the possibility of invalidating and revoking the access of them. To keep the track of JWT tokens, instead of persisting the whole token on the server, you could persist the token identifier (<a href="https://tools.ietf.org/html/rfc7519#section-4.1.7"><code class="language-plaintext highlighter-rouge">jti</code></a> claim) along with some other details such as the user you issued the token for, the expiration date, etc.</p>

<p>When persisting tokens, always consider removing the old ones in order to prevent your database from growing indefinitely.</p>

<h2 id="using-jwt">Using JWT</h2>

<p>There are a few Java libraries to issue and validate JWT tokens such as:</p>

<ul>
  <li><a href="https://github.com/jwtk/jjwt">jjwt</a></li>
  <li><a href="https://github.com/auth0/java-jwt">java-jwt</a></li>
  <li><a href="https://bitbucket.org/b_c/jose4j/wiki/Home">jose4j</a></li>
</ul>

<p>To find some other great resources to work with JWT, have a look at <a href="http://jwt.io/">http://jwt.io</a>.</p>

<h3 id="handling-token-refreshment-with-jwt">Handling token refreshment with JWT</h3>

<p>Accept <em>only</em> valid (and non-expired) tokens for refreshment. Its responsability of the client to refresh the tokens before the expiration date indicated in the <a href="https://tools.ietf.org/html/rfc7519#section-4.1.4"><code class="language-plaintext highlighter-rouge">exp</code></a> claim.</p>

<p>You should prevent the tokens from being refreshed indefinitely. See below a few approaches that you could consider.</p>

<p>You could keep the track of token refreshment by adding two claims to your token (the claim names are up to you):</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">refreshLimit</code>: Indicates how many times the token can be refreshed.</li>
  <li><code class="language-plaintext highlighter-rouge">refreshCount</code>: Indicates how many times the token has been refreshed.</li>
</ul>

<p>So only refresh the token if the following conditions are true:</p>

<ul>
  <li>The token is not expired (<code class="language-plaintext highlighter-rouge">exp &gt;= now</code>).</li>
  <li>The number of times that the token has been refreshed is less than the number of times that the token can be refreshed (<code class="language-plaintext highlighter-rouge">refreshCount &lt; refreshLimit</code>).</li>
</ul>

<p>And when refreshing the token:</p>

<ul>
  <li>Update the expiration date (<code class="language-plaintext highlighter-rouge">exp = now + some-amount-of-time</code>).</li>
  <li>Increment the number of times that the token has been refreshed (<code class="language-plaintext highlighter-rouge">refreshCount++</code>).</li>
</ul>

<p>Alternatively to keeping the track of the number of refreshments, you could have a claim that indicates the <em>absolute expiration date</em> (which works pretty similar to the <code class="language-plaintext highlighter-rouge">refreshLimit</code> claim described above). Before the <em>absolute expiration date</em>, any number of refreshments is acceptable.</p>

<p>Another approach involves issuing a separate long-lived refresh token that is used to issue short-lived JWT tokens.</p>

<p>The best approach depends on your requirements.</p>

<h3 id="handling-token-revocation-with-jwt">Handling token revocation with JWT</h3>

<p>If you want to revoke tokens, you must keep the track of them. You dont need to store the whole token on server side, store only the token identifier (that must be unique) and some metadata if you need. For the token identifier you could use <a href="https://tools.ietf.org/html/rfc4122">UUID</a>.</p>

<p>The <a href="https://tools.ietf.org/html/rfc7519#section-4.1.7"><code class="language-plaintext highlighter-rouge">jti</code></a> claim should be used to store the token identifier on the token. When validating the token, ensure that it has not been revoked by checking the value of the <a href="https://tools.ietf.org/html/rfc7519#section-4.1.7"><code class="language-plaintext highlighter-rouge">jti</code></a> claim against the token identifiers you have on server side.</p>

<p>For security purposes, revoke all the tokens for a user when they change their password.</p>

<h2 id="additional-information">Additional information</h2>

<ul>
  <li>It doesnt matter which type of authentication you decide to use. <strong>Always</strong> do it on the top of a HTTPS connection to prevent the <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">man-in-the-middle attack</a>.</li>
  <li>Take a look at <a href="https://security.stackexchange.com/q/19676">this question</a> from Information Security for more information about tokens.</li>
  <li>
    <p><a href="https://stormpath.com/blog/token-auth-spa/">In this article</a> you will find some useful information about token-based authentication.</p>

  </li>
</ul>

    </div>

    <div class="post__navigation">
      
      
      <a class="next" href="/2015/06/07/adding-maven-dependencies-to-arquillian-test/">
        <img class="post__nav-image lazy" data-src="/assets/images/posts/2015-06-07-adding-maven-dependencies-to-arquillian-test/cover.jpg" alt="Adding Maven dependencies to Arquillian test">
        <div class="post__nav-box">
          <div class="post__nav post__nav__next">Next Post <i class="lni lni-chevron-right"></i></div>
          <h4 class="post__nav__title">Adding Maven dependencies to Arquillian test</h4>
        </div>
      </a>
      
    </div>

  </article>
</div>
<!-- end post -->







<div class="container">
  <div class="related-posts is-related">
    <div class="row">
      <div class="col col-12">
        <div class="container__inner">
          <h3 class="related-title">You may also like</h3>
          <div class="row grid">

          
            
            

            

            

            <div class="article col col-4 col-d-6 col-t-12 grid__post">
              <div class="article__inner">

                
                <a class="article__image" href="/2022/07/15/java-functional-interfaces-reference/">
                  <img class="lazy" data-src="/assets/images/posts/2022-07-15-java-functional-interfaces-reference/cover.jpg" alt="Java functional interfaces reference">
                </a>
                

                <div class="article__content">

                  <div class="article__meta">
                    <span class="article__minutes">
                      
                      
                        8 min read 
                      
                      <time class="article__date" datetime="2022-07-15T17:00:00+00:00">15 Jul 2022</time>
                    </span>
                  </div>

                  <h2 class="article__title">Java functional interfaces reference</h2>

                  <p class="article__excerpt"></p>

                  <div class="article__bottom">

                    
                    <div class="article__author">
                      <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
                    </div>
                    

                    <div class="article__bottom-meta">
                      
                        <a href="/about/" class="article__author-link">cassiomolin</a>
                      
                      
                      <span>in</span>
                      <span class="article-tags">
                        
                          <a href="/tag/java" class="article__tag">java</a>
                        
                      </span>
                      
                    </div>
                  </div>

                </div>

              </div>
            </div>

            
                
              
            
            
            

            

            
            
            
            

            

            
            
            
            

            

            

            <div class="article col col-4 col-d-6 col-t-12 grid__post">
              <div class="article__inner">

                
                <a class="article__image" href="/2019/08/19/combining-jackson-streaming-api-with-objectmapper-for-parsing-json/">
                  <img class="lazy" data-src="/assets/images/posts/2019-08-19-combining-jackson-streaming-api-with-objectmapper-for-parsing-json/cover.jpg" alt="Combining the Jackson Streaming API with ObjectMapper for parsing JSON">
                </a>
                

                <div class="article__content">

                  <div class="article__meta">
                    <span class="article__minutes">
                      
                      
                        7 min read 
                      
                      <time class="article__date" datetime="2019-08-19T17:00:00+00:00">19 Aug 2019</time>
                    </span>
                  </div>

                  <h2 class="article__title">Combining the Jackson Streaming API with ObjectMapper for parsing JSON</h2>

                  <p class="article__excerpt"></p>

                  <div class="article__bottom">

                    
                    <div class="article__author">
                      <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
                    </div>
                    

                    <div class="article__bottom-meta">
                      
                        <a href="/about/" class="article__author-link">cassiomolin</a>
                      
                      
                      <span>in</span>
                      <span class="article-tags">
                        
                          <a href="/tag/java" class="article__tag">java</a>
                        
                          <a href="/tag/jackson" class="article__tag">jackson</a>
                        
                          <a href="/tag/json" class="article__tag">json</a>
                        
                      </span>
                      
                    </div>
                  </div>

                </div>

              </div>
            </div>

            
                
              
            
            
            

            

            

            <div class="article col col-4 col-d-6 col-t-12 grid__post">
              <div class="article__inner">

                
                <a class="article__image" href="/2019/08/08/comparing-json-documents-in-java-with-jsonp/">
                  <img class="lazy" data-src="/assets/images/posts/2019-08-08-comparing-json-documents-in-java-with-jsonp/cover.jpg" alt="Comparing JSON documents in Java with JSON-P">
                </a>
                

                <div class="article__content">

                  <div class="article__meta">
                    <span class="article__minutes">
                      
                      
                        9 min read 
                      
                      <time class="article__date" datetime="2019-08-08T23:00:00+00:00">08 Aug 2019</time>
                    </span>
                  </div>

                  <h2 class="article__title">Comparing JSON documents in Java with JSON-P</h2>

                  <p class="article__excerpt"></p>

                  <div class="article__bottom">

                    
                    <div class="article__author">
                      <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
                    </div>
                    

                    <div class="article__bottom-meta">
                      
                        <a href="/about/" class="article__author-link">cassiomolin</a>
                      
                      
                      <span>in</span>
                      <span class="article-tags">
                        
                          <a href="/tag/java" class="article__tag">java</a>
                        
                          <a href="/tag/json" class="article__tag">json</a>
                        
                          <a href="/tag/javax-json" class="article__tag">javax-json</a>
                        
                      </span>
                      
                    </div>
                  </div>

                </div>

              </div>
            </div>

            
                
                  
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

 <!-- begin comments -->
<div class="container">
  <div class="row">
    <div class="col col-12">
      <div class="disqus-inner">
        <div id="disqus_thread" class="post-comments">
          <div id="disqus_empty"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function load_disqus() {
    var disqus_shortname = 'cassiomolin',
      is_disqus_empty = document.getElementById('disqus_empty'),
      disqus_target = document.getElementById('disqus_thread'),
      disqus_embed = document.createElement('script'),
      disqus_hook = (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]);

    if (disqus_target && is_disqus_empty) {
      disqus_embed.type = 'text/javascript';
      disqus_embed.async = true;
      disqus_embed.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      disqus_hook.appendChild(disqus_embed);
      is_disqus_empty.remove();
    }
  }

  window.addEventListener('scroll', function (e) {
    var currentScroll = document.scrollingElement.scrollTop;
    var disqus_target = document.getElementById('disqus_thread');

    if (disqus_target && (currentScroll > disqus_target.getBoundingClientRect().top - 150)) {
      load_disqus('disqus_shortname');
    }
  }, false);

</script>
<noscript>Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<!-- end comments --> 
  </main> 
  <!-- end content -->
  
  <div class="top" title="Top"><i class="lni lni-chevron-up"></i></div>
  <!-- begin footer-widgets -->
<section class="footer-widgets">
  <div class="container">
    <div class="row">
      <div class="col col-6 col-d-6 col-t-12">
  <div class="widget widget-recent">

    <div class="widget__head">
      <h3 class="widget__title">Latest Posts</h3>
    </div>

    
    <div class="recent-posts">
      
      <a class="recent-posts__image" href="/2022/07/15/java-functional-interfaces-reference/"><img class="lazy" data-src="/assets/images/posts/2022-07-15-java-functional-interfaces-reference/cover.jpg" alt="Java functional interfaces reference"></a>
      
      <div class="recent-posts__content">
        <div class="article__meta">
          <span class="article__minutes">
            
            
              8 min read 
            
          </span>
          <time class="article__date"
            datetime="2022-07-15T17:00:00+00:00">15 Jul 2022</time>
        </div>
        <h4 class="recent-posts__title"><a href="/2022/07/15/java-functional-interfaces-reference/">Java functional interfaces reference</a></h4>
        <div class="article__bottom">
          <div class="article__author">
            <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
          </div>
          <div class="article__bottom-meta">
            <a href="/about/" class="article__author-link">cassiomolin</a>
          </div>
        </div>
      </div>
    </div>
    
    <div class="recent-posts">
      
      <a class="recent-posts__image" href="/2021/07/29/should-http-put-create-a-resource-if-it-does-not-exist/"><img class="lazy" data-src="/assets/images/posts/2021-07-29-should-http-put-create-a-resource-if-it-does-not-exist/cover.jpg" alt="Should HTTP PUT create a resource if it does not exist?"></a>
      
      <div class="recent-posts__content">
        <div class="article__meta">
          <span class="article__minutes">
            
            
              3 min read 
            
          </span>
          <time class="article__date"
            datetime="2021-07-29T17:00:00+00:00">29 Jul 2021</time>
        </div>
        <h4 class="recent-posts__title"><a href="/2021/07/29/should-http-put-create-a-resource-if-it-does-not-exist/">Should HTTP PUT create a resource if it does not exist?</a></h4>
        <div class="article__bottom">
          <div class="article__author">
            <a href="/about/" aria-label="cassiomolin"><img class="article__author-image lazy" data-src="/assets/images/cassiomolin.jpg" alt="cassiomolin's Picture"></a>
          </div>
          <div class="article__bottom-meta">
            <a href="/about/" class="article__author-link">cassiomolin</a>
          </div>
        </div>
      </div>
    </div>
    

  </div>
</div>
      
<div class="col col-6 col-d-6 col-t-12">
  <div class="widget widget-tag-cloud">
    <div class="widget__head">
      <h3 class="widget__title">Explore Tags</h3>
    </div>
    <div class="tag__cloud">
      <a href="/tag/arquillian/" class="set-1">arquillian</a> <a href="/tag/authentication/" class="set-1">authentication</a> <a href="/tag/bean-validation/" class="set-1">bean-validation</a> <a href="/tag/beats/" class="set-1">beats</a> <a href="/tag/cdi/" class="set-1">cdi</a> <a href="/tag/docker/" class="set-1">docker</a> <a href="/tag/dto/" class="set-1">dto</a> <a href="/tag/ejb/" class="set-1">ejb</a> <a href="/tag/elastic-stack/" class="set-1">elastic-stack</a> <a href="/tag/elasticsearch/" class="set-1">elasticsearch</a> <a href="/tag/gson/" class="set-1">gson</a> <a href="/tag/guava/" class="set-1">guava</a> <a href="/tag/http/" class="set-1">http</a> <a href="/tag/jackson/" class="set-2">jackson</a> <a href="/tag/java/" class="set-5">java</a> <a href="/tag/javax-json/" class="set-1">javax-json</a> <a href="/tag/jax-rs/" class="set-1">jax-rs</a> <a href="/tag/jersey/" class="set-1">jersey</a> <a href="/tag/json/" class="set-3">json</a> <a href="/tag/junit/" class="set-1">junit</a> <a href="/tag/kibana/" class="set-1">kibana</a> <a href="/tag/log/" class="set-1">log</a> <a href="/tag/logback/" class="set-1">logback</a> <a href="/tag/logstash/" class="set-1">logstash</a> <a href="/tag/maven/" class="set-1">maven</a> <a href="/tag/patch/" class="set-1">patch</a> <a href="/tag/personal/" class="set-1">personal</a> <a href="/tag/rest/" class="set-1">rest</a> <a href="/tag/servlet/" class="set-1">servlet</a> <a href="/tag/slf4j/" class="set-1">slf4j</a> <a href="/tag/spring-boot/" class="set-1">spring-boot</a> <a href="/tag/test/" class="set-1">test</a>
    </div>
  </div>
</div>

    </div>
  </div>
</section>
<!-- end footer-widgets -->

<!-- begin footer -->
<footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col col-12">
      <div class="footer__inner">
        <div class="copyright">
          2023 &copy; <a href="/">cassiomolin</a>. Written with <i class="lni lni-heart-filled"></i> in Ireland.<br/>
          Powered by <a target="_blank" href="https://jekyllrb.com">Jekyll</a> and hosted on <a target="_blank" href="https://pages.github.com">GitHub Pages</a>.
        </div>
        
<div class="social">
  <ul class="social__list list-reset">
    
    <li class="social__item">
      <a class="social__link" href="https://www.linkedin.com/in/cassiomolin" aria-label="social icon"><i class="lni lni-linkedin-original"></i></a>
    </li>
    
    <li class="social__item">
      <a class="social__link" href="https://www.stackoverflow.com/u/1426227" aria-label="social icon"><i class="lni lni-stackoverflow"></i></a>
    </li>
    
    <li class="social__item">
      <a class="social__link" href="https://github.com/cassiomolin" aria-label="social icon"><i class="lni lni-github-original"></i></a>
    </li>
    
  </ul>
</div>

        </div>
      </div>
    </div>
  </div>
</footer>
<!-- end footer -->
  <script src="/assets/js/vendors/jquery-3.5.1.min.js"></script>
<script src="/assets/js/vendors/simple-jekyll-search.min.js"></script>
<script src="/assets/js/vendors/jquery.fitvids.js"></script>
<script src="/assets/js/vendors/lazyload.min.js"></script>
<script src="/assets/js/vendors/transition.js"></script>
<script src="/assets/js/vendors/zoom.min.js"></script>
<script src="/assets/js/vendors/prism.js"></script>
<script src="/assets/js/vendors/mermaid.min.js"></script>
<script src="/assets/js/common.js"></script>
<script>
  var base_url = "",
    pagination_next_url = base_url + '/page2',
    pagination_next_page_number = '',
    pagination_available_pages_number = '';
</script>
</body>

</html>